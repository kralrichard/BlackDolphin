<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Black Dolphine - Mafia Oyunu</title>
  <style>
    :root {
      --bg-dark: #121212;
      --bg-light: #f4f4f4;
      --panel-dark: #1e1e1e;
      --accent: #e63946;
      --text-light: #f4f4f4;
      --text-dark: #333;
    }
    * {
      margin: 0; padding: 0; box-sizing: border-box;
      font-family: 'Segoe UI', sans-serif;
    }
    html, body { height: 100%; }
    body {
      display: flex; flex-direction: column;
      background: var(--bg-light);
      color: var(--text-dark);
      overflow: hidden;
    }
    /* HEADER */
    header {
      background: var(--bg-dark);
      color: var(--text-light);
      padding: 0.5rem 1rem;
      display: flex; justify-content: space-between; align-items: center;
      flex-shrink: 0;
    }
    .logo { font-size: 1.4rem; font-weight: bold; }
    .balance {
      background: #222; padding: 0.5rem 1rem;
      border-radius: 4px; color: lime;
    }

    /* CENTER RANKS */
    #centerRanks {
      display: flex; justify-content: center; gap: 2rem;
      padding: 1rem; flex-shrink: 0;
      background: var(--bg-light);
    }
    .card {
      background: var(--panel-dark);
      color: var(--text-light);
      padding: 1rem; border-radius: 8px;
      text-align: center; width: 120px;
      cursor: pointer;
    }
    .card.locked { opacity: 0.5; pointer-events: none; }
    .card h2 {
      margin-bottom: 0.5rem; text-transform: uppercase;
    }
    .card button {
      background: var(--accent); border: none;
      color: #fff; padding: 0.5rem 1rem;
      border-radius: 4px; cursor: pointer;
    }

    /* OVERLAY (MODAL) */
    #overlay {
      position: fixed; top:0; left:0;
      width:100%; height:100%;
      background: rgba(0,0,0,0.7);
      display: none; align-items: center; justify-content: center;
    }
    #panel {
      background: var(--bg-light);
      width: 90%; max-width: 600px; max-height: 80%;
      overflow-y: auto; border-radius: 8px;
      padding: 1rem; position: relative;
    }
    #closeBtn {
      position: absolute; top:0.5rem; right:0.5rem;
      background: var(--accent); border:none;
      color:#fff; padding:0.3rem 0.6rem;
      border-radius:4px; cursor:pointer;
    }
    .rankSection { margin-bottom: 1rem; }
    .rankSection h3 {
      color: var(--accent); margin-bottom: 0.5rem;
    }
    .taskItem {
      background: #ddd; padding:0.5rem;
      border-radius:4px; display:flex;
      justify-content: space-between;
      margin-bottom:0.3rem;
    }
    .taskItem.done { background: #a8e6cf; }
    .taskItem button {
      background: var(--accent); border:none;
      color:#fff; padding:0.3rem 0.6rem;
      border-radius:4px; cursor:pointer;
    }

    /* RAILS */
    .rail-container {
      position: relative; height: 60px; flex-shrink: 0;
      margin: 0 1rem;
    }
    canvas.rail { width: 100%; height: 100%; }
    .rail-label {
      position:absolute; top:10px; left:20px;
      color: var(--text-dark); font-weight:bold;
    }
    .rail-label.return { top:auto; bottom:10px; }

    /* MOBILE */
    @media (max-width:768px) {
      header { flex-direction:column; text-align:center; }
      .balance { margin-top:0.5rem; }
      #centerRanks { flex-wrap:wrap; gap:1rem; }
      .rail-container { display:none; }
      #overlay { padding:1rem; }
      #panel { width:100%; max-width:none; max-height:90%; }
    }
  </style>
</head>
<body>
  <header>
    <div class="logo">BLACK DOLPHINE</div>
    <div class="balance">$500,000</div>
  </header>

  <!-- Gidiş Rayı -->
  <div class="rail-container">
    <div class="rail-label">Gidiş Rotası</div>
    <canvas id="railOut" class="rail"></canvas>
  </div>

  <!-- Rank Kartları -->
  <div id="centerRanks">
    <div class="card" id="cardVakur">
      <h2>VAKUR</h2>
      <button onclick="openTasks('Vakur')">Serüven</button>
    </div>
    <div class="card locked" id="cardHatip">
      <h2>HATİP</h2>
      <button onclick="openTasks('Hatip')">Serüven</button>
    </div>
    <div class="card locked" id="cardBaron">
      <h2>BARON</h2>
      <button onclick="openTasks('Baron')">Serüven</button>
    </div>
  </div>

  <!-- Dönüş Rayı -->
  <div class="rail-container">
    <div class="rail-label return">Dönüş Rotası</div>
    <canvas id="railBack" class="rail"></canvas>
  </div>

  <!-- Görev Modali -->
  <div id="overlay" onclick="closeTasks()">
    <div id="panel" onclick="event.stopPropagation()">
      <button id="closeBtn" onclick="closeTasks()">Görevleri Kapat</button>
      <h1 id="taskHeader"></h1>
      <div id="taskSections"></div>
    </div>
  </div>

  <script>
    // Köy listesi (ray için)
    const villages = [
      "Asman","Mizrin","Qeruk","Twılveser","Ashma","Ogean","Karuk","Tilkarut",
      "Midep","Ömerk","Tilal","Olik","Mıshecerk","Mızelb","Kergü","Cinnık",
      "Bostancı","Masucark","Kırıkan","Kuzluk","Qeremsal","Medırbaz",
      "Hecuk","Zebeşker","Mirğan","Dideri","Kazıka","Nehlnehli",
      "Birdirej","Cembel","Mizar","Tihonek","Giregewr","Keferqub",
      "Marut","Avamur","Bubık","Aşme","Oğan"
    ];

    // Görev verileri
    const tasks = {
      Vakur: [
        { title:'ÇIRAK VAKUR I', tasks: [
          'Bir çocuğun okul çantası almasına yardımcı ol.',
          'Mahalledeki yaşlı bir komşunun alışveriş poşetlerini taşı.',
          'Sokaktaki sahipsiz bir köpek için su ve mama koy.',
          'Arkadaşına ufak bir hediye vererek moralini yükselt.',
          'İşsiz bir tanıdığına CV hazırlama konusunda destek ol.',
          'Kütüphanede eski kitapları düzenlemeye gönüllü ol.',
          'Bir hayır kurumuna ufak bir bağış yap veya yardım topla.',
          'Otobüste yaşlı veya hamile birine yer ver.',
          'Mahalle parkında çöp toplama etkinliğine katıl.',
          'Arkadaşına küçük bir sürpriz parti düzenle.'
        ]},
        { title:'USTA VAKUR II', tasks: [
          'Aile içinde tartışan iki akrabayı barıştır.',
          'Mahallede yardım kermesi organize et.',
          'Maddi durumu kötü bir öğrenciye burs ayarla.',
          'Bir STK’nın etkinliğinde aktif rol al.',
          'Bakımsız parkı onarmak için gönüllüler topla.',
          'Kan bağışı kampanyasına katkıda bulun.',
          'Bir arkadaşın için profesyonel yardım aracılığı yap.',
          'Zorbalığa uğrayan birine çevrimiçi destek bul.',
          'Engelliler için kamu binalarına erişim kolaylığı sağla.',
          'Sokak hayvanları için geçici barınak oluştur.'
        ]}
      ],
      Hatip: [
        // Hatip görevlerini aynı yapı ile ekleyin
      ],
      Baron: [
        // Baron görevlerini ekleyin
      ]
    };

    let done     = { Vakur: 0, Hatip: 0, Baron: 0 };
    let total    = { 
      Vakur: tasks.Vakur.flatMap(s=>s.tasks).length,
      Hatip: tasks.Hatip.flatMap(s=>s.tasks).length,
      Baron: tasks.Baron.flatMap(s=>s.tasks).length
    };
    let unlocked = { Vakur: true, Hatip: false, Baron: false };

    // Ray çizimi
    function drawRail(id, baseColor, markColor) {
      const c = document.getElementById(id);
      const ctx = c.getContext('2d');
      c.width = c.offsetWidth;
      c.height = c.offsetHeight;
      // ana çizgi
      ctx.strokeStyle = baseColor;
      ctx.lineWidth = 4;
      ctx.beginPath();
      ctx.moveTo(0, c.height/2);
      ctx.lineTo(c.width, c.height/2);
      ctx.stroke();
      // durak işaretleri
      ctx.strokeStyle = markColor;
      ctx.lineWidth = 2;
      villages.forEach((_,i) => {
        const x = c.width * ((i+1)/(villages.length+1));
        ctx.beginPath();
        ctx.moveTo(x, c.height/2 - 10);
        ctx.lineTo(x, c.height/2 + 10);
        ctx.stroke();
      });
    }

    window.onload = () => {
      drawRail('railOut', '#555', '#e63946');
      drawRail('railBack', '#555', '#a8dadc');
    };
    window.onresize = () => {
      drawRail('railOut', '#555', '#e63946');
      drawRail('railBack', '#555', '#a8dadc');
    };

    // Görev modalını aç/kapa
    function openTasks(rank) {
      if (!unlocked[rank]) {
        return alert(`${rank} kilitli! Önce önceki rankı tamamlayın.`);
      }
      document.getElementById('taskHeader').innerText = `${rank} Görevleri`;
      const container = document.getElementById('taskSections');
      container.innerHTML = '';

      tasks[rank].forEach(section => {
        const secDiv = document.createElement('div');
        secDiv.className = 'rankSection';
        const h3 = document.createElement('h3');
        h3.innerText = section.title;
        secDiv.appendChild(h3);

        section.tasks.forEach(text => {
          const taskDiv = document.createElement('div');
          taskDiv.className = 'taskItem';
          const span = document.createElement('span');
          span.innerText = text;
          const btn = document.createElement('button');
          btn.innerText = '✔';
          btn.onclick = () => completeTask(rank, btn);
          taskDiv.appendChild(span);
          taskDiv.appendChild(btn);
          secDiv.appendChild(taskDiv);
        });

        container.appendChild(secDiv);
      });

      document.getElementById('overlay').style.display = 'flex';
    }

    function completeTask(rank, btn) {
      btn.disabled = true;
      btn.parentElement.classList.add('done');
      done[rank]++;
      if (rank==='Vakur' && done.Vakur===total.Vakur) {
        unlocked.Hatip = true;
        document.getElementById('cardHatip').classList.remove('locked');
        alert('Tebrikler! Hatip görevleri açıldı.');
      }
      if (rank==='Hatip' && done.Hatip===total.Hatip) {
        unlocked.Baron = true;
        document.getElementById('cardBaron').classList.remove('locked');
        alert('Tebrikler! Baron görevleri açıldı.');
      }
      if (rank==='Baron' && done.Baron===total.Baron) {
        alert('Tebrikler! Tüm görevleri tamamladınız.');
      }
    }

    function closeTasks() {
      document.getElementById('overlay').style.display = 'none';
    }
  </script>

</body>
</html>
