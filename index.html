<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Black Dolphine – Mafia Oyunu</title>
  <style>
    /* ================== Variables ================== */
    :root {
      --bg-dark: #121212;
      --bg-light: #f4f4f4;
      --panel-dark: #1e1e1e;
      --accent-vakur: #007bff;
      --accent-hatip: #fd7e14;
      --accent-baron: #dc3545;
      --text-light: #f4f4f4;
      --text-dark: #333;
      --nav-width: 220px;
      --nav-bg: #1e1e1e;
      --nav-hover: #2a2a2a;
      --transition: 0.3s;
    }
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI',sans-serif; }
    html, body { height:100%; overflow:hidden; }
    body { display:flex; background:var(--bg-light); color:var(--text-dark); }

    /* ========== NAVIGATION (LEFT SIDEBAR) ========== */
    nav {
      width:var(--nav-width); background:var(--nav-bg); color:var(--text-light);
      display:flex; flex-direction:column;
    }
    nav ul { flex:1; overflow-y:auto; }
    nav li { }
    nav li a {
      display:flex; align-items:center;
      padding:12px 20px; color:inherit; text-decoration:none;
      border-left:4px solid transparent;
      transition:background var(--transition), border-left var(--transition);
    }
    nav li a:hover { background:var(--nav-hover); }
    nav li a.active { background:var(--accent-vakur); border-left:4px solid var(--accent-hatip); }
    nav .search { padding:10px; }
    nav .search input {
      width:100%; padding:8px; border:none; border-radius:4px;
      transition:box-shadow var(--transition);
    }
    nav .search input:focus { outline:none; box-shadow:0 0 5px rgba(0,123,255,0.5); }

    /* ========== MAIN LAYOUT ========== */
    main {
      flex:1; display:flex; flex-direction:column; overflow:hidden;
    }
    header {
      background:var(--bg-dark); color:var(--text-light);
      display:flex; justify-content:space-between; align-items:center;
      padding:0.5rem 1rem; flex-shrink:0;
      box-shadow:0 2px 4px rgba(0,0,0,0.5);
    }
    .logo { font-size:1.6rem; font-weight:bold; letter-spacing:1px; }
    .balance {
      background:#222; padding:0.5rem 1rem; border-radius:4px;
      color:lime; font-weight:bold;
    }

    /* ========== PROGRESS (DURUMUM PANEL) ========== */
    #durumPanel .progress-group { margin-bottom:1.5rem; }
    #durumPanel .progress-label {
      display:flex; justify-content:space-between; margin-bottom:0.4rem;
      font-weight:bold;
    }
    #durumPanel .progress-bar {
      width:100%; height:10px; background:#ddd; border-radius:5px; overflow:hidden;
    }
    #durumPanel .progress-bar > div {
      height:100%; width:0; background:var(--accent-vakur);
      transition:width var(--transition);
    }
    #durumPanel .badges { margin-top:0.5rem; }
    #durumPanel .badge {
      display:inline-block; width:16px; height:16px;
      border-radius:50%; background:var(--accent-vakur); margin-right:6px;
      box-shadow:0 0 4px rgba(0,0,0,0.3);
    }

    /* ========== TRAIN RAILS ========== */
    .rail-container {
      position:relative; height:60px; flex-shrink:0; margin:0 1rem;
    }
    canvas.rail { width:100%; height:100%; }
    .rail-label {
      position:absolute; top:10px; left:20px;
      font-size:0.9rem; font-weight:bold; color:var(--text-dark);
    }
    .rail-label.return { bottom:10px; top:auto; }

    /* ========== CENTER CARDS ========== */
    #centerRanks {
      display:flex; justify-content:center; gap:2rem;
      padding:1rem; flex-shrink:0;
    }
    .card {
      background:var(--panel-dark); color:var(--text-light);
      padding:1.2rem; border-radius:10px; text-align:center;
      width:140px; cursor:pointer;
      box-shadow:0 4px 8px rgba(0,0,0,0.5);
      transition:transform var(--transition), box-shadow var(--transition);
      position:relative;
    }
    .card:hover { transform:translateY(-4px); box-shadow:0 8px 16px rgba(0,0,0,0.7); }
    .card.locked { opacity:0.4; pointer-events:none; }
    .card h2 { margin-bottom:0.6rem; letter-spacing:1px; }
    .card button {
      background:var(--accent-vakur); border:none; color:#fff;
      padding:0.4rem 1rem; border-radius:5px; font-weight:bold;
      transition:background var(--transition);
    }
    .card button:hover { background:darken(var(--accent-vakur),10%); }
    .card .progress-mini {
      position:absolute; bottom:10px; left:10px; right:10px;
      height:6px; background:#555; border-radius:3px; overflow:hidden;
    }
    .card .progress-mini > div {
      height:100%; width:0; background:var(--accent-vakur);
      transition:width var(--transition);
    }

    /* ========== ASIDE PANELS ========== */
    aside {
      width:260px; background:var(--panel-dark); color:var(--text-light);
      overflow-y:auto; flex-shrink:0;
    }
    .panel { display:none; padding:20px; border-bottom:1px solid #333; }
    .panel.active { display:block; }
    .panel h3 { margin-bottom:12px; color:var(--accent-vakur); font-size:1.1rem; }
    .sub-tabs { display:flex; gap:8px; flex-wrap:wrap; margin-bottom:12px; }
    .sub-tabs button {
      background:#444; border:none; color:var(--text-light);
      padding:6px 12px; border-radius:5px; cursor:pointer;
      transition:background var(--transition);
    }
    .sub-tabs button.active { background:var(--accent-vakur); }
    .sub-content ul {
      list-style:none; max-height:200px; overflow-y:auto; padding-left:0;
    }
    .sub-content li { display:flex; justify-content:space-between; margin-bottom:8px; }
    .sub-content li button {
      background:var(--accent-vakur); border:none; color:#fff;
      padding:4px 8px; border-radius:4px; cursor:pointer;
    }

    /* ========== OVERLAY / MODAL ========== */
    #overlay {
      position:fixed; top:0; left:0; width:100%; height:100%;
      background:rgba(0,0,0,0.7); display:none;
      align-items:center; justify-content:center; z-index:100;
    }
    #panel {
      background:var(--bg-light); width:90%; max-width:600px;
      max-height:80%; overflow-y:auto; border-radius:10px;
      padding:1.5rem; position:relative; box-shadow:0 8px 16px rgba(0,0,0,0.6);
    }
    #closeBtn {
      position:absolute; top:0.8rem; right:0.8rem;
      background:var(--accent-baron); border:none; color:#fff;
      padding:0.4rem 0.8rem; border-radius:5px; cursor:pointer;
      font-weight:bold;
    }
    .rankSection { margin-bottom:1.2rem; }
    .rankSection h3 { color:var(--accent-vakur); margin-bottom:0.6rem; }
    .taskItem {
      background:#ddd; padding:0.6rem; display:flex; justify-content:space-between;
      border-radius:6px; margin-bottom:0.4rem;
      transition:background var(--transition);
    }
    .taskItem.done { background:#a8e6cf; }
    .taskItem button {
      background:var(--accent-hatip); border:none; color:#fff;
      padding:0.3rem 0.6rem; border-radius:4px; cursor:pointer;
      transition:background var(--transition);
    }
    .taskItem button:hover { background:darken(var(--accent-hatip),10%); }

    /* ========== CHAT BOX & ICON ========== */
    #chatBox {
      position:fixed; bottom:20px; left:50%; transform:translateX(-50%);
      width:60%; background:var(--panel-dark); color:var(--text-light);
      padding:10px; border-radius:8px; max-height:200px; overflow-y:auto;
      z-index:50; box-shadow:0 4px 8px rgba(0,0,0,0.5);
    }
    #messageIcon {
      position:fixed; bottom:20px; right:20px;
      background:var(--accent-hatip); padding:12px;
      border-radius:50%; color:#fff; cursor:pointer;
      box-shadow:0 4px 8px rgba(0,0,0,0.5);
      z-index:50;
    }

    /* ========== MOBILE ========== */
    @media(max-width:768px){
      nav, aside { width:100%; order:2; }
      nav ul { display:flex; overflow-x:auto; flex-wrap:nowrap; }
      nav li a { flex-shrink:0; white-space:nowrap; }
      main { order:1; }
      header { justify-content:center; }
      .balance { display:none; }
      .rail-container { display:none; }
      #centerRanks { flex-wrap:wrap; gap:1rem; }
      .panel { padding:12px; }
      #chatBox { width:90%; bottom:10px; }
      #messageIcon { bottom:10px; right:10px; }
    }
  </style>
</head>
<body>
  <nav>
    <ul>
      <li><a href="#" onclick="togglePanel('durum')" class="active">Durumum</a></li>
      <li><a href="#" onclick="togglePanel('aile')">Ailem</a></li>
      <li><a href="#" onclick="togglePanel('tuccar')">Tüccar</a></li>
      <li><a href="#" onclick="togglePanel('mesajlar')">Mesajlarım</a></li>
      <li><a href="#" onclick="togglePanel('avlan')">Avlan</a></li>
      <li><a href="#" onclick="togglePanel('acikArttirma')">Açık Arttırma</a></li>
      <li><a href="#" onclick="togglePanel('kacak')">Kaçakçılık</a></li>
      <li><a href="#" onclick="openTasks('Vakur')">Vakur Görevleri</a></li>
      <li><a href="#" onclick="openTasks('Hatip')">Hatip Görevleri</a></li>
      <li><a href="#" onclick="openTasks('Baron')">Baron Görevleri</a></li>
      <li><a href="#" onclick="togglePanel('atYarisi')">At Yarışı</a></li>
      <li><a href="#" onclick="togglePanel('atBilgiler')">At Bilgileri</a></li>
      <li><a href="#" onclick="togglePanel('oyunIci')">Oyun İçi Bilgiler</a></li>
      <li><a href="#" onclick="togglePanel('aranan')">Arananlar</a></li>
      <li><a href="#" onclick="togglePanel('oyunlar')">Oyunlar</a></li>
      <li><a href="#" onclick="togglePanel('koy')">Köy İncelemesi</a></li>
      <li><a href="#" onclick="togglePanel('tren')">Tren Seyahatleri</a></li>
    </ul>
    <div class="search"><input placeholder="Kullanıcı ara..."></div>
  </nav>

  <main>
    <header>
      <div class="logo">BLACK DOLPHINE</div>
      <div class="balance">$500.000</div>
    </header>

    <div class="rail-container">
      <div class="rail-label">Gidiş Rotası</div>
      <canvas id="railOut" class="rail"></canvas>
    </div>

    <div id="centerRanks">
      <div class="card" id="cardVakur" onclick="openTasks('Vakur')">
        <h2>VAKUR</h2>
        <button>Serüven</button>
        <div class="progress-mini"><div id="miniVakur"></div></div>
      </div>
      <div class="card locked" id="cardHatip" onclick="openTasks('Hatip')">
        <h2>HATİP</h2>
        <button>Serüven</button>
        <div class="progress-mini"><div id="miniHatip" style="background:var(--accent-hatip)"></div></div>
      </div>
      <div class="card locked" id="cardBaron" onclick="openTasks('Baron')">
        <h2>BARON</h2>
        <button>Serüven</button>
        <div class="progress-mini"><div id="miniBaron" style="background:var(--accent-baron)"></div></div>
      </div>
    </div>

    <div class="rail-container">
      <div class="rail-label return">Dönüş Rotası</div>
      <canvas id="railBack" class="rail"></canvas>
    </div>
  </main>

  <aside>
    <div class="panel active" id="durumPanel">
      <h3>Durumum</h3>
      <div class="progress-group">
        <div class="progress-label"><span>Vakur (%<span id="pctVakur">0</span>)</span></div>
        <div class="progress-bar"><div id="barVakur" style="background:var(--accent-vakur)"></div></div>
        <div class="badges" id="badgesVakur"></div>
      </div>
      <div class="progress-group">
        <div class="progress-label"><span>Hatip (%<span id="pctHatip">0</span>)</span></div>
        <div class="progress-bar"><div id="barHatip" style="background:var(--accent-hatip)"></div></div>
        <div class="badges" id="badgesHatip"></div>
      </div>
      <div class="progress-group">
        <div class="progress-label"><span>Baron (%<span id="pctBaron">0</span>)</span></div>
        <div class="progress-bar"><div id="barBaron" style="background:var(--accent-baron)"></div></div>
        <div class="badges" id="badgesBaron"></div>
      </div>
    </div>
    <div class="panel" id="ailePanel"><h3>Ailem</h3><ul><li>Üye 1</li><li>Üye 2</li></ul></div>
    <div class="panel" id="tuccarPanel"><h3>Tüccar</h3><ul><li>Silah – 2500$</li><li>Bomba –1000$</li></ul></div>
    <div class="panel" id="mesajlarPanel"><h3>Mesajlarım</h3><ul><li>Mesaj 1</li></ul></div>
    <div class="panel" id="avlanPanel"><h3>Avlan</h3><ul><li>Görev 1</li></ul></div>
    <div class="panel" id="acikArttirmaPanel"><h3>Açık Arttırma</h3><ul><li>Item A</li></ul></div>
    <div class="panel" id="kacakPanel"><h3>Kaçakçılık</h3><ul><li>Görev 1</li></ul></div>
    <div class="panel" id="atYarisiPanel"><h3>At Yarışı</h3><ul><li>Yarış 1</li></ul></div>
    <div class="panel" id="atBilgilerPanel"><h3>At Bilgileri</h3><ul><li>Karabey – Hız:85</li></ul></div>
    <div class="panel" id="oyunIciPanel"><h3>Oyun İçi Bilgiler</h3><p>Rehber, ipuçları vb.</p></div>
    <div class="panel" id="arananPanel"><h3>Arananlar</h3><ul><li>Karakter A</li></ul></div>
    <div class="panel" id="oyunlarPanel"><h3>Oyunlar</h3><ul><li>Mod 1</li></ul></div>
    <div class="panel" id="koyPanel"><h3>Köy İncelemesi</h3><div class="sub-tabs" id="koyTabs"></div><div class="sub-content" id="koyPages"></div></div>
    <div class="panel" id="trenPanel"><h3>Tren Seyahatleri</h3><div class="sub-tabs" id="trenTabs"></div><div class="sub-content" id="trenPages"></div></div>
  </aside>

  <div id="overlay" onclick="closeTasks()">
    <div id="panel" onclick="event.stopPropagation()">
      <button id="closeBtn" onclick="closeTasks()">Kapat</button>
      <h1 id="taskHeader"></h1>
      <div id="taskSections"></div>
    </div>
  </div>

  <div id="chatBox" contenteditable="true">CHAT başlıyor…</div>
  <div id="messageIcon">📩</div>

  <script>
    // ----- Köyler & Rail Çizimi -----
    let villages=["Asman","Mizrin","Qeruk","Twılveser","Ashma","Ogean","Karuk","Tilkarut","Midep","Emerk","Tilal","Olik","Mıshecerk","Mızelb","Kergü","Cinnık","Masucark","Kırıkan","Kuzluk","Qeremsal","Medırbaz","Hecuk","Zebeşker","Mirğan","Dideri","Kazıka","Nehlnehli","Birdirej","Cembel","Mizar","Tihonek","Giregewr","Keferqub","Marut","Avamur","Bubık","Aşme","Oğan","Mirxan","Thashluk"];
    function drawRail(id,col1,col2){const c=document.getElementById(id),ctx=c.getContext('2d');c.width=c.offsetWidth; c.height=c.offsetHeight;ctx.strokeStyle=col1;ctx.lineWidth=4;ctx.beginPath();ctx.moveTo(0,c.height/2);ctx.lineTo(c.width,c.height/2);ctx.stroke();ctx.strokeStyle=col2;ctx.lineWidth=2;villages.forEach((_,i)=>{let x=c.width*(i+1)/(villages.length+1);ctx.beginPath();ctx.moveTo(x,c.height/2-10);ctx.lineTo(x,c.height/2+10);ctx.stroke();});}
    window.onload=()=>{drawRail('railOut', '#555', getComputedStyle(document.documentElement).getPropertyValue('--accent-vakur')); drawRail('railBack', '#555', getComputedStyle(document.documentElement).getPropertyValue('--accent-baron')); initTabs('koyTabs','koyPages',villages); initTabs('trenTabs','trenPages',villages); loadProgress();};
    window.onresize=()=>{drawRail('railOut', '#555', getComputedStyle(document.documentElement).getPropertyValue('--accent-vakur')); drawRail('railBack', '#555', getComputedStyle(document.documentElement).getPropertyValue('--accent-baron'));};

    // ----- Sidebar Panel Toggle -----
    function togglePanel(id){ document.querySelectorAll('nav li a').forEach(a=>a.classList.remove('active')); document.querySelectorAll('aside .panel').forEach(p=>p.classList.remove('active')); event.target.classList.add('active'); document.getElementById(id+'Panel').classList.add('active'); }

    // ----- Tabs Init -----
    function initTabs(tabId,pageId,items){ const tabs=document.getElementById(tabId), pages=document.getElementById(pageId); tabs.innerHTML=''; pages.innerHTML=''; const per=8, count=Math.ceil(items.length/per); for(let p=0;p<count;p++){ let btn=document.createElement('button'); btn.innerText=p+1; btn.onclick=()=>showPage(p,tabId,pageId); tabs.appendChild(btn); let div=document.createElement('div'); div.className='sub-content'; let ul=document.createElement('ul'); for(let i=p*per;i<Math.min((p+1)*per,items.length);i++){ let li=document.createElement('li'); li.innerHTML=`${items[i]} <button onclick="travelTo('${items[i]}')">Git</button>`; ul.appendChild(li);} div.appendChild(ul); pages.appendChild(div);} showPage(0,tabId,pageId);} function showPage(idx,tabId,pageId){ document.querySelectorAll(`#${tabId} button`).forEach(b=>b.classList.remove('active')); document.querySelectorAll(`#${pageId} .sub-content`).forEach(c=>c.style.display='none'); document.querySelectorAll(`#${tabId} button`)[idx].classList.add('active'); document.querySelectorAll(`#${pageId} .sub-content`)[idx].style.display='block'; } function travelTo(v){ alert(v+' köyüne gittiniz.'); }

    // ----- Task Data -----
    const tasks={/* as above (omitted for brevity) */};
    let done=JSON.parse(localStorage.getItem('done'))||{Vakur:0,Hatip:0,Baron:0};
    const total={Vakur:tasks.Vakur.flatMap(s=>s.tasks).length, Hatip:tasks.Hatip.flatMap(s=>s.tasks).length, Baron:tasks.Baron.flatMap(s=>s.tasks).length};

    // ----- Progress -----
    function updateProgress(){ ['Vakur','Hatip','Baron'].forEach(rank=>{ let pct= total[rank]? Math.min(100,Math.floor(done[rank]/total[rank]*100)) : 0; document.getElementById('pct'+rank).innerText=pct; document.getElementById('bar'+rank).style.width=pct+'%'; document.getElementById('mini'+rank).style.width=pct+'%'; let badges=document.getElementById('badges'+rank); badges.innerHTML=''; let count=Math.floor(done[rank]/50); for(let i=0;i<count;i++){ let b=document.createElement('span'); b.className='badge'; if(rank==='Hatip') b.style.background=getComputedStyle(document.documentElement).getPropertyValue('--accent-hatip'); if(rank==='Baron') b.style.background=getComputedStyle(document.documentElement).getPropertyValue('--accent-baron'); badges.appendChild(b);} }); localStorage.setItem('done',JSON.stringify(done)); }
    function loadProgress(){ updateProgress(); }

    // ----- Task Modal -----
    function openTasks(rank){ if(rank==='Hatip' && done.Vakur<total.Vakur) return alert('Önce tüm Vakur görevlerini tamamla!'); if(rank==='Baron' && done.Hatip<total.Hatip) return alert('Önce tüm Hatip görevlerini tamamla!'); document.getElementById('taskHeader').innerText=rank+' Görevleri'; let secEl=document.getElementById('taskSections'); secEl.innerHTML=''; tasks[rank].forEach(sec=>{ let d=document.createElement('div'); d.className='rankSection'; let h=document.createElement('h3'); h.innerText=sec.title; d.appendChild(h); sec.tasks.forEach(t=>{ let ti=document.createElement('div'); ti.className='taskItem'; let sp=document.createElement('span'); sp.innerText=t; let btn=document.createElement('button'); btn.innerText='✔'; btn.onclick=()=>{ ti.classList.add('done'); btn.disabled=true; done[rank]++; updateProgress(); }; ti.appendChild(sp); ti.appendChild(btn); d.appendChild(ti); }); secEl.appendChild(d); }); document.getElementById('overlay').style.display='flex'; }
    function closeTasks(){ document.getElementById('overlay').style.display='none'; }
  </script>
</body>
</html>
