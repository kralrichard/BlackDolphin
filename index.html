<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Black Dolphine ‚Äì Mafia Oyunu</title>
  <style>
    :root {
      --bg-dark: #121212;
      --bg-light: #f4f4f4;
      --panel-dark: #1e1e1e;
      --blue: #457b9d;
      --orange: #f4a261;
      --red: #e63946;
      --text-light: #f4f4f4;
      --text-dark: #333;
    }
    * { margin:0; padding:0; box-sizing:border-box; font-family:'Segoe UI',sans-serif; }
    html, body { height:100%; }
    body { display:flex; background:var(--bg-light); color:var(--text-dark); overflow:hidden; }
    nav { width:220px; background:var(--panel-dark); color:var(--text-light); display:flex; flex-direction:column; }
    nav ul { list-style:none; flex:1; overflow:auto; }
    nav li a { display:block; padding:12px 20px; color:inherit; text-decoration:none; border-bottom:1px solid #333; }
    nav li a:hover, nav li a.active { background:var(--accent); }
    nav li a.vakur-link:hover, nav li a.vakur-link.active { background:var(--blue); }
    nav li a.hatip-link:hover, nav li a.hatip-link.active { background:var(--orange); }
    nav li a.baron-link:hover, nav li a.baron-link.active { background:var(--red); }
    nav .search { padding:10px; }
    nav .search input { width:100%; padding:8px; border:none; border-radius:4px; }
    main { flex:1; display:flex; flex-direction:column; overflow:auto; }
    header { background:var(--bg-dark); color:var(--text-light); padding:.5rem 1rem; display:flex; justify-content:space-between; align-items:center; }
    .logo { font-size:1.4rem; font-weight:bold; }
    .balance { background:#222; padding:.5rem 1rem; border-radius:4px; color:lime; }
    .rail-container { position:relative; height:60px; margin:1rem; }
    canvas.rail { width:100%; height:100%; }
    .rail-label { position:absolute; top:10px; left:20px; color:var(--text-dark); font-weight:bold; }
    .rail-label.return { top:auto; bottom:10px; }
    #centerRanks { display:flex; justify-content:center; gap:2rem; padding:1rem; }
    .card { padding:1rem; border-radius:8px; text-align:center; color:var(--text-light); width:120px; cursor:pointer; }
    .card.vakur { background:var(--blue); }
    .card.hatip { background:var(--orange); }
    .card.baron { background:var(--red); }
    .card.locked { opacity:.5; pointer-events:none; }
    .card h2 { margin-bottom:.5rem; text-transform:uppercase; }
    .card button { background:#fff; color:#000; border:none; padding:.5rem 1rem; border-radius:4px; }
    aside { width:260px; background:var(--panel-dark); color:var(--text-light); overflow:auto; }
    .panel { padding:20px; display:none; }
    .panel.active { display:block; }
    .panel h3 { margin-bottom:10px; color:var(--blue); }
    .status-bar { margin-bottom:1rem; }
    .status-bar h4 { margin-bottom:.3rem; }
    .bar { width:100%; height:12px; background:#ccc; border-radius:6px; overflow:hidden; }
    .bar .fill { height:100%; width:0; }
    .bar.blue .fill { background:var(--blue); }
    .bar.orange .fill { background:var(--orange); }
    .bar.red .fill { background:var(--red); }
    #overlay { position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,.7); display:none; align-items:center; justify-content:center; }
    #panel { background:var(--bg-light); width:90%; max-width:600px; max-height:80%; overflow:auto; border-radius:8px; padding:1rem; position:relative; }
    #closeBtn { position:absolute; top:.5rem; right:.5rem; background:#000; color:#fff; border:none; padding:.3rem .6rem; border-radius:4px; cursor:pointer; }
    .rankSection { margin-bottom:1rem; }
    .rankSection h3 { color:var(--blue); margin-bottom:.5rem; }
    .taskItem { background:#ddd; padding:.5rem; display:flex; justify-content:space-between; border-radius:4px; margin-bottom:.3rem; }
    .taskItem.done { background:#a8e6cf; }
    .taskItem button { background:var(--blue); border:none; color:#fff; padding:.3rem .6rem; border-radius:4px; display:inline-block; }
    @media(max-width:768px) {
      body { flex-direction:column; }
      nav, aside { width:100%; }
      main { order:1; }
      header { justify-content:center; }
      .balance { display:none; }
      .rail-container { display:none; }
      #centerRanks { flex-wrap:wrap; gap:1rem; }
    }
  </style>
</head>
<body>

  <nav>
    <ul>
      <li><a href="#" onclick="togglePanel('durum')" class="active">Durumum</a></li>
      <li><a href="#" class="vakur-link" onclick="openTasks('Vakur')">Vakur G√∂revleri</a></li>
      <li><a href="#" class="hatip-link" onclick="openTasks('Hatip')">Hatip G√∂revleri</a></li>
      <li><a href="#" class="baron-link" onclick="openTasks('Baron')">Baron G√∂revleri</a></li>
    </ul>
    <div class="search"><input placeholder="Kullanƒ±cƒ± ara..."></div>
  </nav>

  <main>
    <header>
      <div class="logo">BLACK DOLPHINE</div>
      <div class="balance">$500¬†000</div>
    </header>

    <div class="rail-container">
      <div class="rail-label">Gidi≈ü Rotasƒ±</div>
      <canvas id="railOut" class="rail"></canvas>
    </div>

    <div id="centerRanks">
      <div id="cardVakur" class="card vakur" onclick="openTasks('Vakur')">
        <h2>VAKUR</h2>
        <button>Ser√ºven</button>
      </div>
      <div id="cardHatip" class="card hatip locked" onclick="openTasks('Hatip')">
        <h2>HATƒ∞P</h2>
        <button>Ser√ºven</button>
      </div>
      <div id="cardBaron" class="card baron locked" onclick="openTasks('Baron')">
        <h2>BARON</h2>
        <button>Ser√ºven</button>
      </div>
    </div>

    <div class="rail-container">
      <div class="rail-label return">D√∂n√º≈ü Rotasƒ±</div>
      <canvas id="railBack" class="rail"></canvas>
    </div>
  </main>

  <aside>
    <div id="durumPanel" class="panel active">
      <h3>Durumum</h3>
      <!-- Savunma Metriƒüi -->
      <div class="status-bar">
        <h4>üî∞ Savunma</h4>
        <div class="bar blue"><div id="barSavunma" class="fill"></div></div>
      </div>
      <!-- Sav Rozet -->
      <div class="status-bar">
        <h4>üî∞ Rozet</h4>
        <div class="bar blue"><div id="barSavRozet" class="fill"></div></div>
      </div>
      <!-- N√ºfus -->
      <div class="status-bar">
        <h4>üë• N√ºfus</h4>
        <div class="bar orange"><div id="barNufus" class="fill"></div></div>
      </div>
      <!-- N√º Rozet -->
      <div class="status-bar">
        <h4>üë• Rozet</h4>
        <div class="bar orange"><div id="barNufRozet" class="fill"></div></div>
      </div>
      <!-- Etki -->
      <div class="status-bar">
        <h4>üè∞ Etki</h4>
        <div class="bar red"><div id="barEtki" class="fill"></div></div>
      </div>
      <!-- Et Rozet -->
      <div class="status-bar">
        <h4>üè∞ Rozet</h4>
        <div class="bar red"><div id="barEtRozet" class="fill"></div></div>
      </div>
    </div>
  </aside>

  <div id="overlay" onclick="closeTasks()">
    <div id="panel" onclick="event.stopPropagation()">
      <button id="closeBtn" onclick="closeTasks()">Kapat ‚úñ</button>
      <h1 id="taskHeader"></h1>
      <div id="taskSections"></div>
    </div>
  </div>

  <script>
    const perRozet = 50, maxRozet = 4;
    let done = JSON.parse(localStorage.done||'{}');
    if(!done.Vakur) done={Vakur:0,Hatip:0,Baron:0};

    function updateBars(){
      const map = [
        ['Vakur','barSavunma','barSavRozet','blue'],
        ['Hatip','barNufus','barNufRozet','orange'],
        ['Baron','barEtki','barEtRozet','red']
      ];
      map.forEach(([r,metricId,rozId,color])=>{
        const d = done[r], metr = Math.min(100,d/(perRozet*maxRozet)*100);
        document.getElementById(metricId).style.width = metr+'%';
        const roz = Math.min(maxRozet,Math.floor(d/perRozet));
        document.getElementById(rozId).style.width = (roz/maxRozet*100)+'%';
      });
      // kilit a√ßma
      if(done.Vakur>=perRozet) document.getElementById('cardHatip').classList.remove('locked');
      if(done.Hatip>=perRozet) document.getElementById('cardBaron').classList.remove('locked');
    }

    const tasks = { Vakur:[], Hatip:[], Baron:[] };
    for(let r of ['Vakur','Hatip','Baron']){
      for(let i=1;i<=5;i++){
        let sec={ title:`${['√áIRAK','USTA','UZMAN','EFSANE','Y√úCE'][i-1]} ${r.toUpperCase()} ${i}`, tasks:[] };
        for(let j=1;j<=50;j++) sec.tasks.push(`${r} g√∂revi ${((i-1)*50+j)}`);
        tasks[r].push(sec);
      }
    }

    function openTasks(rank){
      if(rank!=='Vakur' && done[rank]<perRozet) return alert(`${rank} kilitli!`);
      const header = document.getElementById('taskHeader');
      header.innerText = rank+' G√∂revleri';
      const secEl = document.getElementById('taskSections');
      secEl.innerHTML = '';
      tasks[rank].forEach((sec, idx)=>{
        if(done[rank] < idx*50) return;
        const div = document.createElement('div'); div.className='rankSection';
        const h = document.createElement('h3'); h.innerText = sec.title; div.appendChild(h);
        sec.tasks.forEach(txt=>{
          const ti = document.createElement('div'); ti.className='taskItem';
          const sp = document.createElement('span'); sp.innerText = txt;
          const btn = document.createElement('button'); btn.innerText='‚úî';
          btn.onclick = ()=>{
            done[rank]++; localStorage.done = JSON.stringify(done);
            ti.classList.add('done'); btn.disabled=true;
            updateBars();
            if(idx===4 && done[rank]>=250){ closeTasks(); done[rank]=0; localStorage.done=JSON.stringify(done); updateBars(); }
          };
          ti.append(sp,btn); div.appendChild(ti);
        });
        secEl.appendChild(div);
      });
      document.getElementById('overlay').style.display='flex';
    }

    function closeTasks(){ document.getElementById('overlay').style.display='none'; }
    function togglePanel(id){
      document.querySelectorAll('nav li a').forEach(a=>a.classList.remove('active'));
      document.querySelectorAll('aside .panel').forEach(p=>p.classList.remove('active'));
      event.target.classList.add('active');
      document.getElementById(id+'Panel').classList.add('active');
    }

    // basit ray √ßizimi
    function drawRail(id,col1,col2){
      const c=document.getElementById(id),ctx=c.getContext('2d');
      c.width=c.offsetWidth; c.height=c.offsetHeight;
      ctx.strokeStyle=col1; ctx.lineWidth=4;
      ctx.beginPath(); ctx.moveTo(0,c.height/2); ctx.lineTo(c.width,c.height/2); ctx.stroke();
      ctx.strokeStyle=col2; ctx.lineWidth=2;
      for(let i=1;i<=38;i++){
        let x=c.width*(i/39);
        ctx.beginPath(); ctx.moveTo(x,c.height/2-10); ctx.lineTo(x,c.height/2+10); ctx.stroke();
      }
    }
    window.onload = ()=>{
      drawRail('railOut','#555','#e63946');
      drawRail('railBack','#555','#a8dadc');
      updateBars();
    };
    window.onresize = ()=>{
      drawRail('railOut','#555','#e63946');
      drawRail('railBack','#555','#a8dadc');
    };
  </script>
</body>
</html>
