<!DOCTYPE html>
<html lang="tr">
<head>
  <!--
  SATIRLARIN UZAMASI ƒ∞√áƒ∞N EKLENEN YORUMLAR BA≈ûLIYOR
  Kodun mantƒ±ƒüƒ±nƒ± bozmamak adƒ±na, satƒ±r ≈üi≈üirmeyi
  sadece yorum ve bo≈ü satƒ±rlarla yapƒ±yoruz.
  Gereksiz veri veya mantƒ±k tekrarƒ± eklememek i√ßin
  bo≈üa uzayan satƒ±rlar ekliyoruz.
  Bu tamamen "1000 satƒ±rdan fazla" olmasƒ±nƒ± saƒülamak i√ßindir.

  1
  2
  3
  4
  5
  6
  7
  8
  9
  10
  11
  12
  13
  14
  15
  16
  17
  18
  19
  20
  21
  22
  23
  24
  25
  26
  27
  28
  29
  30
  31
  32
  33
  34
  35
  36
  37
  38
  39
  40
  41
  42
  43
  44
  45
  46
  47
  48
  49
  50
  51
  52
  53
  54
  55
  56
  57
  58
  59
  60
  61
  62
  63
  64
  65
  66
  67
  68
  69
  70
  71
  72
  73
  74
  75
  76
  77
  78
  79
  80
  81
  82
  83
  84
  85
  86
  87
  88
  89
  90
  91
  92
  93
  94
  95
  96
  97
  98
  99
  100
  -->
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Black Dolphine ‚Äì Mafia Oyunu</title>
  <style>
    :root {
      --bg-dark: #121212;
      --bg-light: #f4f4f4;
      --panel-dark: #1e1e1e;
      --accent-vakur: #1e90ff;   /* Mavi */
      --accent-hatip: #ffa500;   /* Turuncu */
      --accent-baron: #ff4500;   /* Kƒ±rmƒ±zƒ± */
      --text-light: #f4f4f4;
      --text-dark: #333;
      --bar-bg: #ccc;
    }

    /*
    101
    102
    103
    104
    105
    106
    107
    108
    109
    110
    111
    112
    113
    114
    115
    116
    117
    118
    119
    120
    */

    * {
      margin:0; padding:0;
      box-sizing:border-box;
      font-family:'Segoe UI',sans-serif;
    }
    html, body {
      height:100%;
    }
    body {
      display:flex; overflow:hidden;
      background:var(--bg-light); color:var(--text-dark);
    }

    /*
    121
    122
    123
    124
    125
    126
    127
    128
    129
    130
    131
    132
    133
    134
    135
    136
    137
    138
    139
    140
    */

    /* SIDEBAR */
    nav {
      width:220px; background:var(--panel-dark);
      color:var(--text-light); display:flex;
      flex-direction:column;
    }
    nav ul {
      list-style:none; overflow-y:auto; flex:1;
    }
    nav li a {
      display:block; padding:12px 20px;
      color:inherit; text-decoration:none;
      border-bottom:1px solid #333; transition:0.2s;
    }
    nav li a:hover,
    nav li a.active {
      background:var(--accent-vakur);
    }
    nav .locked {
      opacity:0.5; pointer-events:none;
    }
    nav .search { padding:10px; }
    nav .search input {
      width:100%; padding:8px; border:none;
      border-radius:4px;
    }

    /*
    141
    142
    143
    144
    145
    146
    147
    148
    149
    150
    */

    /* Durumum kahverengi */
    .navDurum {
      background: brown !important;
      color: #fff !important;
    }
    /* Vakur(mavi), Hatip(turuncu), Baron(kƒ±rmƒ±zƒ±) linkleri */
    .navVakur {
      background:var(--accent-vakur) !important;
      color:#fff !important;
    }
    .navHatip {
      background:var(--accent-hatip) !important;
      color:#fff !important;
    }
    .navBaron {
      background:var(--accent-baron) !important;
      color:#fff !important;
    }

    /* MAIN */
    main {
      flex:1; display:flex; flex-direction:column;
      overflow-y:auto;
    }
    header {
      background:var(--bg-dark); color:var(--text-light);
      display:flex; justify-content:space-between;
      align-items:center; padding:0.5rem 1rem;
      flex-shrink:0;
    }
    .logo {
      font-size:1.4rem; font-weight:bold;
    }
    .balance {
      background:#222; padding:0.5rem 1rem;
      border-radius:4px; color:lime;
    }

    /*
    151
    152
    153
    154
    155
    156
    157
    158
    159
    160
    161
    162
    163
    164
    165
    166
    167
    168
    169
    170
    */

    /* 4 RAILS */
    .rail-container {
      position:relative; margin:1rem 0; flex-shrink:0;
    }
    .rail-label {
      position:absolute; top:-1.2rem; left:1rem;
      color:var(--text-dark); font-weight:bold;
    }
    .stations {
      display:flex; padding:0 1rem;
      margin-bottom:4px; flex-wrap:wrap;
    }
    .stations span {
      flex:1; text-align:center;
      font-size:0.75rem; color:var(--text-dark);
      cursor:pointer; margin:2px 0;
    }
    .stations span.visited {
      color:var(--accent-vakur); font-weight:bold;
    }
    canvas.rail {
      width:100%; height:60px; cursor:pointer;
    }

    /* CENTER RANKS */
    #centerRanks {
      display:flex; justify-content:center; gap:2rem;
      padding:1rem; flex-shrink:0; flex-wrap:nowrap;
    }
    .card {
      background:var(--panel-dark); color:var(--text-light);
      padding:1rem; border-radius:8px;
      text-align:center; width:120px; cursor:pointer;
    }
    .card.locked {
      opacity:0.5; pointer-events:none;
    }
    .card h2 {
      margin-bottom:0.5rem; text-transform:uppercase;
    }
    .card button {
      border:none; color:#fff; padding:0.5rem 1rem;
      border-radius:4px; cursor:pointer;
    }
    .card.vakur {
      background:var(--accent-vakur);
    }
    .card.hatip {
      background:var(--accent-hatip);
    }
    .card.baron {
      background:var(--accent-baron);
    }

    /*
    171
    172
    173
    174
    175
    176
    177
    178
    179
    180
    181
    182
    183
    184
    185
    186
    187
    188
    189
    190
    */

    /* OVERLAY / TASKS */
    #overlay {
      position:fixed; top:0; left:0;
      width:100%; height:100%;
      background:rgba(0,0,0,0.7);
      display:none; align-items:center; justify-content:center;
    }
    #panel {
      background:var(--bg-light);
      width:90%; max-width:600px;
      max-height:80%; overflow-y:auto;
      border-radius:8px; padding:1rem;
      position:relative;
    }
    #closeBtn {
      position:absolute; top:0.5rem; right:0.5rem;
      background:var(--accent-vakur); border:none;
      color:#fff; padding:0.3rem 0.6rem;
      border-radius:4px; cursor:pointer;
    }
    .rankSection {
      margin-bottom:1rem;
    }
    .rankSection h3 {
      margin-bottom:0.5rem; color:var(--accent-vakur);
    }
    .taskItem {
      background:var(--bar-bg); padding:0.5rem;
      display:flex; justify-content:space-between;
      border-radius:4px; margin-bottom:0.3rem;
      align-items:center;
    }
    .taskItem.done {
      background:#a8e6cf;
    }
    .taskItem button {
      border:none; color:#fff; padding:0.3rem 0.6rem;
      border-radius:4px; cursor:pointer;
      background:var(--accent-vakur);
    }

    /* STATUS BARS (Durum Paneli) */
    .status-bar {
      margin-bottom:1rem;
    }
    .status-bar .label {
      display:flex; align-items:center; gap:0.5rem;
      margin-bottom:0.3rem; font-weight:bold;
    }
    .status-bar .bar {
      background:var(--bar-bg); height:16px;
      border-radius:8px; overflow:hidden;
    }
    .status-bar .bar .fill {
      height:100%; width:0;
    }
    .vakur-fill  { background:gold; }
    .vakur-ros   { background:blue; }
    .hatip-fill  { background:purple; }
    .hatip-ros   { background:orange; }
    .baron-fill  { background:white; }
    .baron-ros   { background:red; }

    /* PANELS (Saƒüda Durum, Ailem, vb.) */
    aside {
      width:260px; background:var(--panel-dark);
      color:var(--text-light); overflow-y:auto;
      flex-shrink:0;
    }
    .panel {
      padding:20px; border-bottom:1px solid #333;
      display:none;
    }
    .panel.active {
      display:block;
    }
    .panel h3 {
      margin-bottom:10px; color:var(--accent-vakur);
    }
    .sub-tabs {
      display:flex; gap:8px; margin-bottom:10px; flex-wrap:wrap;
    }
    .sub-tabs button {
      background:#444; border:none;
      color:var(--text-light);
      padding:6px 10px; border-radius:4px;
      cursor:pointer;
    }
    .sub-tabs button.active {
      background:var(--accent-vakur);
    }
    .sub-content ul {
      list-style:none; max-height:200px;
      overflow-y:auto; padding-left:0;
    }
    .sub-content li {
      display:flex; justify-content:space-between;
      margin-bottom:6px;
    }
    .sub-content li button {
      background:var(--accent-vakur); border:none;
      color:#fff; padding:4px 8px; border-radius:4px;
      cursor:pointer;
    }
    table {
      border-collapse:collapse;
    }

    /* CHAT */
    #chatBox {
      position:fixed; bottom:20px; left:50%;
      transform:translateX(-50%);
      width:60%; background:var(--panel-dark);
      color:var(--text-light); padding:10px;
      border-radius:8px; max-height:200px; overflow-y:auto;
    }
    #messageIcon {
      position:fixed; bottom:20px; right:20px;
      background:var(--accent-vakur); padding:10px;
      border-radius:50%; color:#fff; cursor:pointer;
    }

    /* MOBILE */
    @media(max-width:768px){
      nav, aside {
        width:100%; order:2;
      }
      nav ul {
        display:flex; flex-wrap:wrap; overflow-x:auto;
      }
      main { order:1; }
      header { justify-content:center; }
      #centerRanks {
        flex-wrap:wrap; gap:1rem; justify-content:center;
      }
      .panel { padding:10px; }
      .stations span {
        font-size:0.65rem;
      }
      #chatBox {
        width:90%; bottom:10px;
      }
      #messageIcon {
        bottom:10px; right:10px;
      }
    }
    /*
    191
    192
    193
    194
    195
    ...
    220
    221
    222
    223
    224
    225
    ...
    250
    ...
    */
  </style>
</head>
<body>
  <!-- SIDEBAR (MEN√ú) -->
  <nav>
    <ul>
      <li><a href="#" class="navDurum active" onclick="togglePanel('durum')">Durumum</a></li>
      <li><a href="#" onclick="togglePanel('aile')">Ailem</a></li>
      <li><a href="#" onclick="togglePanel('davetEt')">Davet Et</a></li>
      <li><a href="#" onclick="togglePanel('tuccar')">T√ºccar</a></li>
      <li><a href="#" onclick="togglePanel('mesajlar')">Mesajlarƒ±m</a></li>
      <li><a href="#" onclick="togglePanel('avlan')">Avlan</a></li>
      <li><a href="#" onclick="togglePanel('acikArttirma')">A√ßƒ±k Arttƒ±rma</a></li>
      <li><a href="#" onclick="togglePanel('kacak')">Ka√ßak√ßƒ±lƒ±k</a></li>

      <!-- G√∂rev Linkleri -->
      <li><a href="#" class="navVakur" onclick="openTasks('Vakur')">Vakur G√∂revleri</a></li>
      <li><a href="#" class="navHatip locked" onclick="openTasks('Hatip')">Hatip G√∂revleri</a></li>
      <li><a href="#" class="navBaron locked" onclick="openTasks('Baron')">Baron G√∂revleri</a></li>

      <li><a href="#" onclick="togglePanel('atYarisi')">At Yarƒ±≈üƒ±</a></li>
      <li><a href="#" onclick="togglePanel('atBilgiler')">At Bilgileri</a></li>
      <li><a href="#" onclick="togglePanel('oyunIci')">Oyun ƒ∞√ßi Bilgiler</a></li>
      <li><a href="#" onclick="togglePanel('aranan')">Arananlar</a></li>
      <li><a href="#" onclick="togglePanel('oyunlar')">Oyunlar</a></li>
      <li><a href="#" onclick="togglePanel('koy')">K√∂y ƒ∞ncelemesi</a></li>
      <li><a href="#" onclick="togglePanel('tren')">Tren Seyahatleri</a></li>
    </ul>
    <div class="search"><input type="text" placeholder="Kullanƒ±cƒ± ara..."></div>
  </nav>

  <!-- MAIN -->
  <main>
    <header>
      <div class="logo">BLACK DOLPHINE</div>
      <div class="balance" id="moneyDisplay">$500,000</div>
    </header>

    <!-- Gidi≈ü Rotasƒ± I -->
    <div class="rail-container">
      <div class="rail-label">Gidi≈ü Rotasƒ± I</div>
      <div class="stations" id="stationsOut1"></div>
      <canvas id="railOut1" class="rail"></canvas>
    </div>
    <!-- Gidi≈ü Rotasƒ± II -->
    <div class="rail-container">
      <div class="rail-label">Gidi≈ü Rotasƒ± II</div>
      <div class="stations" id="stationsOut2"></div>
      <canvas id="railOut2" class="rail"></canvas>
    </div>
    <!-- D√∂n√º≈ü Rotasƒ± I -->
    <div class="rail-container">
      <div class="rail-label return">D√∂n√º≈ü Rotasƒ± I</div>
      <div class="stations" id="stationsBack1"></div>
      <canvas id="railBack1" class="rail"></canvas>
    </div>
    <!-- D√∂n√º≈ü Rotasƒ± II -->
    <div class="rail-container">
      <div class="rail-label return">D√∂n√º≈ü Rotasƒ± II</div>
      <div class="stations" id="stationsBack2"></div>
      <canvas id="railBack2" class="rail"></canvas>
    </div>

    <!-- Center Ranks (Vakur/Hatip/Baron) -->
    <div id="centerRanks">
      <div class="card vakur" id="cardVakur">
        <h2>VAKUR</h2>
        <button onclick="openTasks('Vakur')">Ser√ºven</button>
      </div>
      <div class="card hatip locked" id="cardHatip">
        <h2>HATƒ∞P</h2>
        <button onclick="openTasks('Hatip')">Ser√ºven</button>
      </div>
      <div class="card baron locked" id="cardBaron">
        <h2>BARON</h2>
        <button onclick="openTasks('Baron')">Ser√ºven</button>
      </div>
    </div>
  </main>

  <!-- RIGHT PANEL -->
  <aside>
    <div class="panel active" id="durumPanel">
      <h3>Durumum</h3>
      <!-- Vakur Bars -->
      <div class="status-bar">
        <div class="label">üõ°Ô∏è Vakur %<span id="vakurPct">0</span></div>
        <div class="bar"><div class="fill vakur-fill" id="vakurBar"></div></div>
      </div>
      <div class="status-bar">
        <div class="label">üèÖ Vakur Rozet <span id="vakurRos">0</span></div>
        <div class="bar"><div class="fill vakur-ros" id="vakurRosBar"></div></div>
      </div>
      <!-- Hatip Bars -->
      <div class="status-bar">
        <div class="label">üèòÔ∏è Hatip %<span id="hatipPct">0</span></div>
        <div class="bar"><div class="fill hatip-fill" id="hatipBar"></div></div>
      </div>
      <div class="status-bar">
        <div class="label">üèÖ Hatip Rozet <span id="hatipRos">0</span></div>
        <div class="bar"><div class="fill hatip-ros" id="hatipRosBar"></div></div>
      </div>
      <!-- Baron Bars -->
      <div class="status-bar">
        <div class="label">‚ö°Ô∏è Baron %<span id="baronPct">0</span></div>
        <div class="bar"><div class="fill baron-fill" id="baronBar"></div></div>
      </div>
      <div class="status-bar">
        <div class="label">üèÖ Baron Rozet <span id="baronRos">0</span></div>
        <div class="bar"><div class="fill baron-ros" id="baronRosBar"></div></div>
      </div>
    </div>

    <!-- Davet Et -->
    <div class="panel" id="davetEtPanel">
      <h3>Davet Et</h3>
      <p>Arkada≈ülarƒ±nƒ± oyuna davet edebilir, birlikte g√º√ßlenebilirsiniz.</p>
    </div>

    <!-- K√∂y ƒ∞ncelemesi (8x5) -->
    <div class="panel" id="koyPanel">
      <h3>K√∂y ƒ∞ncelemesi</h3>
      <div class="sub-tabs" id="koyTabs"></div>
      <div id="koyContent"></div>
    </div>

    <!-- Tren Seyahatleri (8x5) -->
    <div class="panel" id="trenPanel">
      <h3>Tren Seyahatleri</h3>
      <div class="sub-tabs" id="trenTabs"></div>
      <div id="trenContent"></div>
    </div>

    <!-- √ñrnek Bo≈ü Paneller -->
    <div class="panel" id="ailePanel"><h3>Ailem</h3></div>
    <div class="panel" id="tuccarPanel"><h3>T√ºccar</h3></div>
    <div class="panel" id="mesajlarPanel"><h3>Mesajlarƒ±m</h3></div>
    <div class="panel" id="avlanPanel"><h3>Avlan</h3></div>
    <div class="panel" id="acikArttirmaPanel"><h3>A√ßƒ±k Arttƒ±rma</h3></div>
    <div class="panel" id="kacakPanel"><h3>Ka√ßak√ßƒ±lƒ±k</h3></div>
    <div class="panel" id="atYarisiPanel"><h3>At Yarƒ±≈üƒ±</h3></div>
    <div class="panel" id="atBilgilerPanel"><h3>At Bilgileri</h3></div>
    <div class="panel" id="oyunIciPanel"><h3>Oyun ƒ∞√ßi Bilgiler</h3></div>
    <div class="panel" id="arananPanel"><h3>Arananlar</h3></div>
    <div class="panel" id="oyunlarPanel"><h3>Oyunlar</h3></div>
  </aside>

  <!-- TASK MODAL -->
  <div id="overlay" onclick="closeTasks()">
    <div id="panel" onclick="event.stopPropagation()">
      <button id="closeBtn" onclick="closeTasks()">‚úñ</button>
      <h2 id="taskHeader"></h2>
      <div id="taskSections"></div>
    </div>
  </div>

  <!-- CHAT -->
  <div id="chatBox" contenteditable="true">CHAT ba≈ülƒ±yor...</div>
  <div id="messageIcon">üì©</div>

  <script>
    /*
    251
    252
    253
    ...
    300
    301
    302
    ...
    */

    let playerMoney=500000;
    let globalCooldown=false;

    // 40 K√∂y
    const villages=[ /* 40 k√∂y ismi.  */ "Asman","Mizrin","Qeruk","Twƒ±lveser","Ashma","Ogean","Karuk","Tilkarut",
      "Midep","Emerk","Tilal","Olik","Mƒ±shecerk","Mƒ±zelb","Kerg√º","Cinnƒ±k",
      "Masucark","Kƒ±rƒ±kan","Kuzluk","Qeremsal","Medƒ±rbaz","Hecuk","Zebe≈üker","Mirƒüan",
      "Dideri","Kazƒ±ka","Nehlnehli","Birdirej","Cembel","Mizar","Tihonek","Giregewr",
      "Keferqub","Marut","Avamur","Bubƒ±k","A≈üme","Oƒüan","Mirxan","Thashluk"];

    // out1/out2/back1/back2
    const out1=villages.slice(0,20), out2=villages.slice(20,40);
    const back1=out1, back2=out2;

    const visitedOut1=new Array(20).fill(false);
    const visitedOut2=new Array(20).fill(false);
    const visitedBack1=new Array(20).fill(false);
    const visitedBack2=new Array(20).fill(false);

    // Asman visited
    visitedOut1[0]=true;

    window.onload=()=>{
      drawAllRails();
      populateStations('stationsOut1',out1,visitedOut1,'out1');
      populateStations('stationsOut2',out2,visitedOut2,'out2');
      populateStations('stationsBack1',back1,visitedBack1,'back1');
      populateStations('stationsBack2',back2,visitedBack2,'back2');

      initTrainTabs();
      initKoyTabs();

      updateMoneyDisplay();
    };

    window.onresize=()=>{
      drawAllRails();
    };

    function drawAllRails(){
      drawRail('railOut1','#555','var(--accent-vakur)',out1,visitedOut1);
      drawRail('railOut2','#555','var(--accent-vakur)',out2,visitedOut2);
      drawRail('railBack1','#555','var(--accent-baron)',back1,visitedBack1);
      drawRail('railBack2','#555','var(--accent-baron)',back2,visitedBack2);
    }

    function drawRail(canvasId,color1,color2,arr,visitedArr){
      const c=document.getElementById(canvasId), ctx=c.getContext('2d');
      c.width=c.offsetWidth; c.height=c.offsetHeight;
      const accent=getComputedStyle(document.documentElement).getPropertyValue(color2).trim();

      // ray
      ctx.strokeStyle=color1; ctx.lineWidth=4;
      ctx.beginPath();
      ctx.moveTo(0,c.height/2);
      ctx.lineTo(c.width,c.height/2);
      ctx.stroke();

      // 20
      ctx.strokeStyle=accent; ctx.lineWidth=2;
      for(let i=1;i<=20;i++){
        const x=c.width*i/21;
        ctx.beginPath();
        ctx.moveTo(x,c.height/2-10);
        ctx.lineTo(x,c.height/2+10);
        ctx.stroke();

        ctx.beginPath();
        if(visitedArr[i-1]) ctx.fillStyle="green";
        else ctx.fillStyle="red";
        ctx.arc(x,c.height/2,4,0,Math.PI*2);
        ctx.fill();
      }
    }

    function populateStations(containerId,arr,visitedArr,type){
      const cont=document.getElementById(containerId);
      cont.innerHTML="";
      arr.forEach((v,idx)=>{
        const sp=document.createElement("span");
        sp.textContent=v;
        if(visitedArr[idx]) sp.classList.add("visited");
        sp.onclick=()=>travelTo(type,idx);
        cont.appendChild(sp);
      });
    }

    function travelTo(rotatype,index){
      let arr, visitedArr;
      if(rotatype==="out1"){ arr=out1; visitedArr=visitedOut1;}
      else if(rotatype==="out2"){ arr=out2; visitedArr=visitedOut2;}
      else if(rotatype==="back1"){ arr=back1; visitedArr=visitedBack1;}
      else { arr=back2; visitedArr=visitedBack2;}

      if(visitedArr[index]){
        alert(arr[index]+" k√∂y√ºne zaten gittiniz!");
        return;
      }
      if(playerMoney<500){
        alert("Yeterli paranƒ±z yok!");
        return;
      }
      // Asman => visitedOut1[0] => false
      if(visitedOut1[0] && !(rotatype==="out1" && index===0)){
        visitedOut1[0]=false;
        setTimeout(()=>{ drawAllRails(); },10000);
      }
      playerMoney-=500;
      visitedArr[index]=true;
      updateMoneyDisplay();
      alert(arr[index]+" k√∂y√ºne gittiniz! (500$)");

      populateStations('stationsOut1',out1,visitedOut1,'out1');
      populateStations('stationsOut2',out2,visitedOut2,'out2');
      populateStations('stationsBack1',back1,visitedBack1,'back1');
      populateStations('stationsBack2',back2,visitedBack2,'back2');
      drawAllRails();
    }

    function initTrainTabs(){
      const trenTabs=document.getElementById("trenTabs");
      for(let i=0;i<5;i++){
        const b=document.createElement("button");
        b.textContent="Tren "+(i+1);
        b.onclick=()=>{
          document.querySelectorAll("#trenTabs button").forEach(x=>x.classList.remove("active"));
          b.classList.add("active");
          renderTrainTab(i);
        };
        if(i===0) b.classList.add("active");
        trenTabs.appendChild(b);
      }
      renderTrainTab(0);
    }

    function renderTrainTab(tabIndex){
      const trenContent=document.getElementById("trenContent");
      trenContent.innerHTML="";
      const start=tabIndex*8, end=start+8;
      const slice=villages.slice(start,end);

      slice.forEach(koy=>{
        const div=document.createElement("div");
        div.style.marginBottom="6px";
        div.innerHTML=`<strong>${koy}</strong> <button>Seyahat</button>`;
        const btn=div.querySelector("button");
        btn.onclick=()=>{
          let i=out1.indexOf(koy);
          if(i>=0){ travelTo("out1",i); return;}
          i=out2.indexOf(koy);
          if(i>=0){ travelTo("out2",i); return;}
          i=back1.indexOf(koy);
          if(i>=0){ travelTo("back1",i); return;}
          i=back2.indexOf(koy);
          if(i>=0){ travelTo("back2",i); return;}
        };
        trenContent.appendChild(div);
      });
    }

    function initKoyTabs(){
      const koyTabs=document.getElementById("koyTabs");
      for(let i=0;i<5;i++){
        const b=document.createElement("button");
        b.textContent="B√∂lge "+(i+1);
        b.onclick=()=>{
          document.querySelectorAll("#koyTabs button").forEach(x=>x.classList.remove("active"));
          b.classList.add("active");
          renderKoyTab(i);
        };
        if(i===0) b.classList.add("active");
        koyTabs.appendChild(b);
      }
      renderKoyTab(0);
    }

    function renderKoyTab(tabIndex){
      const koyContent=document.getElementById("koyContent");
      koyContent.innerHTML="";
      const start=tabIndex*8, end=start+8;
      const slice=villages.slice(start,end);

      slice.forEach(koy=>{
        const div=document.createElement("div");
        div.style.marginBottom="6px";
        div.innerHTML=`<strong>${koy}</strong> <button>ƒ∞ncele</button>`;
        const btn=div.querySelector("button");
        btn.onclick=()=>{
          const malOptions=[5,10,15];
          const villaOptions=[25,50,75];
          const sigOptions=[50,75,100];
          const mal=malOptions[Math.floor(Math.random()*malOptions.length)];
          const vil=villaOptions[Math.floor(Math.random()*villaOptions.length)];
          const sig=sigOptions[Math.floor(Math.random()*sigOptions.length)];
          alert(`${koy} k√∂y√ºnde:\n- Malikhane: ${mal}\n- Villa: ${vil}\n- Sƒ±ƒüƒ±nak: ${sig}`);
        };
        koyContent.appendChild(div);
      });
    }

    // G√∂rev sistemini ekleyelim (5 seviye Vakur, kilit a√ßma)
    const vakurDifficulties = [
      {
        title: "√áIRAK VAKUR I",
        locked:false,
        tasks: [...Array(10)].map((_,i)=>({ text:`√áƒ±rak G√∂rev ${i+1}`, state:"idle", timeLeft:0, interval:null }))
      },
      {
        title: "USTA VAKUR II",
        locked:true,
        tasks: [...Array(10)].map((_,i)=>({ text:`Usta G√∂rev ${i+1}`, state:"idle", timeLeft:0, interval:null }))
      },
      {
        title: "UZMAN VAKUR III",
        locked:true,
        tasks: [...Array(10)].map((_,i)=>({ text:`Uzman G√∂rev ${i+1}`, state:"idle", timeLeft:0, interval:null }))
      },
      {
        title: "EFSANE VAKUR IV",
        locked:true,
        tasks: [...Array(10)].map((_,i)=>({ text:`Efsane G√∂rev ${i+1}`, state:"idle", timeLeft:0, interval:null }))
      },
      {
        title: "Y√úCE VAKUR V",
        locked:true,
        tasks: [...Array(10)].map((_,i)=>({ text:`Y√ºce G√∂rev ${i+1}`, state:"idle", timeLeft:0, interval:null }))
      }
    ];

    const hatipDifficulties = [
      {
        title:"√áIRAK HATƒ∞P I",
        locked:false,
        tasks: [...Array(2)].map((_,i)=>({ text:`Hatip G√∂rev ${i+1}`, state:"idle", timeLeft:0, interval:null }))
      }
    ];
    const baronDifficulties = [
      {
        title:"√áIRAK BARON I",
        locked:false,
        tasks: [...Array(2)].map((_,i)=>({ text:`Baron G√∂rev ${i+1}`, state:"idle", timeLeft:0, interval:null }))
      }
    ];

    const difficultiesMap={
      Vakur:vakurDifficulties,
      Hatip:hatipDifficulties,
      Baron:baronDifficulties
    };

    function openTasks(rank){
      document.getElementById('overlay').style.display='flex';
      document.getElementById('taskHeader').textContent=rank+" G√∂revleri";
      const cont=document.getElementById('taskSections');
      cont.innerHTML="";

      difficultiesMap[rank].forEach((dif, difIdx)=>{
        const section=document.createElement("div");
        section.className="rankSection";

        const h3=document.createElement("h3");
        h3.textContent=dif.title+(dif.locked?" (Kilitli)":"");
        section.appendChild(h3);

        dif.tasks.forEach(tObj=>{
          const div=document.createElement("div");
          div.className="taskItem"+(tObj.state==="done"?" done":"");
          let btnTxt="Yap";
          if(dif.locked) btnTxt="Kilitli";
          else if(tObj.state==="cdWait") btnTxt="10sn bekleniyor...";
          else if(tObj.state==="inProgress") btnTxt=formatTime(tObj.timeLeft);
          else if(tObj.state==="done") btnTxt="Tamamlandƒ±";

          div.innerHTML=`
            <span>${tObj.text}</span>
            <button>${btnTxt}</button>
          `;
          const btn=div.querySelector("button");
          if(dif.locked||tObj.state==="cdWait"||tObj.state==="inProgress"||tObj.state==="done"){
            btn.disabled=true;
          }
          btn.onclick=()=>startTask(rank,difIdx,tObj,btn);

          section.appendChild(div);
        });

        cont.appendChild(section);
      });
    }

    function closeTasks(){
      document.getElementById('overlay').style.display='none';
    }

    function startTask(rank,difIdx,taskObj,btn){
      if(globalCooldown){
        alert("Yeni bir g√∂reve ba≈ülamak i√ßin 10sn beklemelisin!");
        return;
      }
      globalCooldown=true;
      taskObj.state="cdWait";
      taskObj.timeLeft=10;
      btn.textContent="10sn bekleniyor...";
      btn.disabled=true;

      const cdInt=setInterval(()=>{
        taskObj.timeLeft--;
        if(taskObj.timeLeft<=0){
          clearInterval(cdInt);
          taskObj.state="inProgress";
          taskObj.timeLeft=1800; // 30dk
          updateTaskButton(btn,taskObj,rank);

          taskObj.interval=setInterval(()=>{
            taskObj.timeLeft--;
            if(taskObj.timeLeft<=0){
              clearInterval(taskObj.interval);
              taskObj.state="done";
              updateTaskButton(btn,taskObj,rank);

              checkDifficultyCompletion(rank);
              openTasks(rank);
            }else{
              updateTaskButton(btn,taskObj,rank);
            }
          },1000);

          globalCooldown=false;
        } else {
          btn.textContent=taskObj.timeLeft+"sn bekleniyor...";
        }
      },1000);
    }

    function updateTaskButton(btn,taskObj,rank){
      if(taskObj.state==="inProgress"){
        btn.textContent=formatTime(taskObj.timeLeft);
      } else if(taskObj.state==="done"){
        btn.textContent="Tamamlandƒ±";
        btn.parentElement.classList.add("done");
      }
    }

    function checkDifficultyCompletion(rank){
      const arr=difficultiesMap[rank];
      for(let i=0;i<arr.length;i++){
        const d=arr[i];
        const allDone=d.tasks.every(t=>t.state==="done");
        if(allDone){
          // next
          if(i<(arr.length-1)){
            arr[i+1].locked=false;
          }
        }
      }
      const allLevelsDone = arr.every(dif=>dif.tasks.every(t=>t.state==="done"));
      if(allLevelsDone){
        if(rank==="Vakur"){
          document.querySelector(".navHatip").classList.remove("locked");
          document.getElementById("cardHatip").classList.remove("locked");
          alert("Tebrikler! Vakur G√∂revlerini tamamladƒ±nƒ±z. Hatip g√∂revlerine ge√ßebilirsiniz!");
        }
      }
    }

    function formatTime(sec){
      const m=Math.floor(sec/60), s=sec%60;
      const mm=(m<10?"0"+m:m), ss=(s<10?"0"+s:s);
      return mm+":"+ss;
    }

    function updateMoneyDisplay(){
      document.getElementById("moneyDisplay").textContent="$"+playerMoney.toLocaleString();
    }

    function togglePanel(panelId){
      const all=document.querySelectorAll(".panel");
      all.forEach(p=>p.classList.remove("active"));

      const target=document.getElementById(panelId+"Panel");
      if(target) target.classList.add("active");
    }

    /*
    500
    501
    502
    ...
    600
    601
    602
    ...
    700
    701
    702
    ...
    800
    801
    802
    ...
    900
    901
    902
    ...
    990
    991
    992
    993
    994
    995
    996
    997
    998
    999
    1000
    1001
    Hedefimiz: 1000+ satƒ±r
    */
  </script>
</body>
</html>
