<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>Mafia Oyunu</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* Genel Sıfırlama */
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: linear-gradient(120deg, #272727 0%, #111 50%, #000 100%);
      color: #f1f1f1;
      font-family: 'Poppins', sans-serif;
      overflow-x: hidden;
    }
    /* Ana Menü */
    #mainMenu {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      align-items: center;
      gap: 20px;
      background: linear-gradient(135deg, #1a237e, #0d47a1);
    }
    #mainMenu h1 { font-size: 2.5rem; }
    #mainMenu button {
      padding: 15px 30px;
      font-size: 1.2rem;
      border: none;
      border-radius: 8px;
      background: #ff4444;
      color: #fff;
      cursor: pointer;
      transition: background 0.3s;
    }
    #mainMenu button:hover { background: #cc0000; }

    /* Oyun Container'ları (başlangıçta gizli) */
    .game-container { display: none; position: relative; }

    /* Mafia Oyunu Stilleri */
    #mafiaGameContainer {
      padding-top: 120px; /* Üst stat barları için alan */
      min-height: 100vh;
      background: #121212;
    }
    /* Stat Barları (Sol Üst) */
    #statBars {
      position: fixed;
      top: 20px;
      left: 20px;
      width: 280px;
      z-index: 1000;
    }
    .stat-bar {
      margin-bottom: 1rem;
      background: #444;
      border-radius: 5px;
      padding: 5px;
      overflow: hidden;
    }
    .stat-label { font-weight: bold; font-size: 0.9rem; margin-bottom: 3px; }
    .stat-fill {
      height: 20px;
      background: #00bfff;
      width: 0%;
      transition: width 1s ease;
    }
    .stat-text { margin-top: 3px; font-size: 0.9rem; }
    .lockedStat { opacity: 0.4; }
    /* Profil Bilgisi */
    #profileInfo { margin-top: 1rem; font-weight: bold; font-size: 0.9rem; }
    /* Village Travel Panel (Sağ Orta) */
    #villageTravel {
      position: fixed;
      right: 20px;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(0,0,0,0.7);
      padding: 1rem;
      border-radius: 10px;
      width: 200px;
      z-index: 1000;
    }
    #villageTravel h3 { text-align: center; margin-bottom: 1rem; }
    #villageTravel ul { list-style: none; }
    #villageTravel li {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 0.5rem;
    }
    #villageTravel button {
      padding: 5px 10px;
      font-size: 0.8rem;
      border: none;
      border-radius: 5px;
      background: #ff4444;
      color: #fff;
      cursor: pointer;
      transition: background 0.3s;
    }
    #villageTravel button:hover { background: #cc0000; }
    /* Rütbe Kartları */
    .rank-selection {
      display: flex;
      gap: 20px;
      justify-content: center;
      margin: 20px 0;
      flex-wrap: wrap;
    }
    .card {
      background: rgba(255,255,255,0.05);
      border: 1px solid rgba(255,255,255,0.1);
      border-radius: 10px;
      padding: 20px;
      width: 250px;
      transition: transform 0.3s;
      cursor: pointer;
    }
    .card:hover { transform: translateY(-5px); }
    .card h2 { color: #ffcc00; margin-bottom: 10px; }
    .locked {
      opacity: 0.4;
      pointer-events: none;
      position: relative;
    }
    .locked::after {
      content: "KİLİTLİ";
      position: absolute;
      top: 50%; left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.8);
      padding: 5px 10px;
      border-radius: 5px;
      font-weight: bold;
      color: #ff4444;
    }
    /* Görev Alanı */
    .task-container {
      background: rgba(255,255,255,0.07);
      padding: 20px;
      margin: 20px auto;
      max-width: 600px;
      border-radius: 10px;
      position: relative;
    }
    .task-container h3 { color: #ffcc00; margin-bottom: 10px; }
    .close-task {
      position: absolute;
      top: 5px; right: 5px;
      background: transparent;
      border: none;
      color: #fff;
      font-size: 1.2rem;
      cursor: pointer;
    }
    #taskOptions { display: flex; flex-direction: column; gap: 5px; margin-bottom: 10px; }
    .task-option {
      padding: 10px;
      border: 1px solid #555;
      border-radius: 5px;
      background: rgba(255,255,255,0.05);
      text-align: left;
      cursor: default;
    }
    .task-option.active { background: #ff4444; cursor: pointer; }
    .task-option.completed { background: #00bfff; color: #000; }
    .task-option.locked { background: #555; opacity: 0.6; }
    .progress-container {
      width: 100%;
      background: #444;
      border-radius: 5px;
      overflow: hidden;
      margin-top: 5px;
    }
    .progress-bar {
      height: 20px;
      width: 0%;
      background: #00bfff;
      transition: width 1s ease;
    }
    .progress-text { margin-top: 5px; font-weight: bold; }
    /* Ana Menüye Dön Butonu */
    #mafiaMenu button { margin-top: 10px; }
    /* SABİT BUTON GRUBU */
    .fixed-btn-group {
      position: fixed;
      bottom: 20px;
      right: 20px;
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .fixed-btn-group .btn { min-width: 130px; }
  </style>
</head>
<body>
  <!-- ANA MENÜ -->
  <div id="mainMenu">
    <h1>Oyun Seçimi</h1>
    <button onclick="showGame('mafia')">Mafia Oyunu</button>
  </div>

  <!-- MAFIA OYUNU -->
  <div id="mafiaGameContainer" class="game-container">
    <!-- Stat Barları ve Profil -->
    <div id="statBars">
      <div class="stat-bar" id="vakurStat">
        <div class="stat-label">Vakur 🛡️</div>
        <div class="stat-fill" id="vakurFill"></div>
        <div class="stat-text" id="vakurText">Koruma: 0 (0%)</div>
      </div>
      <div class="stat-bar lockedStat" id="hatipStat">
        <div class="stat-label">Hatip 👥</div>
        <div class="stat-fill" id="hatipFill"></div>
        <div class="stat-text" id="hatipText">Nüfus: 0 (0%)</div>
      </div>
      <div class="stat-bar lockedStat" id="baronStat">
        <div class="stat-label">Baron ♛</div>
        <div class="stat-fill" id="baronFill"></div>
        <div class="stat-text" id="baronText">Etki: 0 (0%)</div>
      </div>
      <div id="profileInfo">Köy: <span id="currentVillageDisplay">Asman</span></div>
    </div>
    <!-- Village Travel Panel -->
    <div id="villageTravel">
      <h3>Köyler</h3>
      <ul>
        <li><span>Asman</span><button onclick="travelTo('Asman')">Seyahat Et</button></li>
        <li><span>Mizrin</span><button onclick="travelTo('Mizrin')">Seyahat Et</button></li>
        <li><span>Qeruk</span><button onclick="travelTo('Qeruk')">Seyahat Et</button></li>
        <li><span>Shuman</span><button onclick="travelTo('Shuman')">Seyahat Et</button></li>
        <li><span>Alizera</span><button onclick="travelTo('Alizera')">Seyahat Et</button></li>
        <li><span>Bubuk</span><button onclick="travelTo('Bubuk')">Seyahat Et</button></li>
      </ul>
    </div>
    <!-- Rütbe Kartları ve Görev Alanı -->
    <div id="mafiaMenu">
      <div class="rank-selection">
        <div class="card" id="cardVakur">
          <h2>Vakur</h2>
          <p>Mavi 🏅</p>
          <button class="btn" onclick="selectRank('Vakur')">Seç</button>
        </div>
        <div class="card locked" id="cardHatip">
          <h2>Hatip</h2>
          <p>Turuncu 🏅</p>
          <button class="btn" onclick="selectRank('Hatip')">Seç</button>
        </div>
        <div class="card locked" id="cardBaron">
          <h2>Baron</h2>
          <p>Kırmızı 🏅</p>
          <button class="btn" onclick="selectRank('Baron')">Seç</button>
        </div>
      </div>
      <!-- Görev Alanı -->
      <div class="task-container" id="taskContainer">
        <button class="close-task" onclick="closeTaskContainer()">X</button>
        <h3 id="rankTitle"></h3>
        <div id="taskOptions"></div>
        <div class="progress-container">
          <div class="progress-bar" id="progressBar"></div>
        </div>
        <div class="progress-text" id="progressText">0%</div>
      </div>
      <br>
      <button class="btn" onclick="showMainMenu()">Ana Menüye Dön</button>
    </div>
  </div>

  <script>
    /* ------------------------
       MAFA OYUNU KODLARI
    ------------------------ */
    // Rütbe görev dizileri (basit, orta, zor, ileri, son)
    const mafiaTierOrder = ["basit", "orta", "zor", "ileri", "son"];
    const mafiaTasks = {
      vakur: {
        basit: [
          "Bir çocuğun okul çantası almasına yardımcı ol.",
          "Mahalledeki yaşlı bir komşunun alışveriş poşetlerini taşı.",
          "Sokaktaki sahipsiz bir köpek için su ve mama koy.",
          "Arkadaşına ufak bir hediye vererek moralini yükselt.",
          "İşsiz bir tanıdığına CV hazırlama konusunda destek ol.",
          "Kütüphanede eski kitapları düzenlemeye gönüllü ol.",
          "Bir hayır kurumuna ufak bağış yap veya yardım topla.",
          "Otobüste yaşlı veya hamile birine yer ver."
        ],
        orta: [
          "Aile içinde tartışan iki akrabayı barıştır.",
          "Mahallede yardım kermesi veya etkinlik organize et.",
          "Maddi durumu kötü bir öğrenciye burs/kitap yardımı ayarla.",
          "Bir STK’nın etkinliğinde aktif rol al.",
          "Bakımsız parkı onarmak için gönüllüler topla.",
          "Kan bağışı kampanyasına katkıda bulun.",
          "Bir arkadaşın için profesyonel yardım aracılığı yap.",
          "Zorbalığa uğrayan birine çevrimiçi destek bul."
        ],
        zor: [
          "Afet bölgesine yardım ekibi olarak katıl.",
          "Kronik sorunu için belediyeyle görüşüp çözüm talep et.",
          "Zor durumdaki aileye iş veya barınma imkânı sağla.",
          "Hayvan barınağında kapsamlı bakım ve temizlik yap.",
          "Küs olan iki arkadaşın barışmasına aracılık et.",
          "Toplum dışlanmış birini etkinliklere dahil et.",
          "Küçük çaplı bağış kampanyası düzenle.",
          "Yerel hastanede gönüllü refakat programına katıl."
        ],
        ileri: [
          "Büyük ölçekli yardım projesine liderlik et.",
          "Gençlere yönelik mentorluk programı başlat.",
          "Meslek edindirme kursu organize et.",
          "Toplumsal soruna belediye-STK ortaklığıyla çözüm üret.",
          "Gönüllü ekibi kurarak yaşlı bakımevlerini ziyaret et.",
          "Okullarda 'empati ve yardımseverlik' semineri düzenle.",
          "Sosyal medya kampanyasıyla yardım toplama etkinliği düzenle.",
          "Ücretsiz terapi/rehberlik günü organize et."
        ],
        son: [
          "Ulusal çapta sosyal sorumluluk projesi yürüt.",
          "Büyük bağış konseri/festival düzenle.",
          "Gönüllüleri bir araya getiren platform kur.",
          "Eğitim bursu fonu başlat.",
          "Aile içi şiddete karşı koruma ve rehabilitasyon hizmetleri oluştur.",
          "Yardım vakfı kurarak sürekli yardım yürüt.",
          "Uluslararası STK’lerle iş birliği yaparak yurt dışına yardım taşı.",
          "Tebrikler, hatip oldunuz! Ana menüye dönüyorsunuz."
        ]
      },
      hatip: {
        basit: [
          "Sokak kavgasını tatlı dille sakinleştir.",
          "Arkadaşlar arasındaki tartışmayı yapıcı sözlerle çöz.",
          "Aile içi gerginliği dinleyerek gider.",
          "Sosyal medyada tartışmayı tatlıya bağla.",
          "Yanlış bilgiyi doğru kaynakla düzelt.",
          "Dedikoduyu kaynağından çürüterek sakinleştir.",
          "Okul/kulüp etkinliğinde kısa konuşma yap.",
          "Ufak grupta hitabet pratiği yap."
        ],
        orta: [
          "Komşular arasındaki sorunu toplantı ile çöz.",
          "İş yerindeki iletişim kopukluğunu arabuluculuk yaparak gider.",
          "Yerel hayır kurumuna bağış toplamak için ikna et.",
          "Küçük öğrenci grubuna hitabet eğitimi düzenle.",
          "Aile şirketinde tartışmada hakemlik yap.",
          "Sivil toplum girişiminde gönüllü konuşmacı ol.",
          "Mahalle muhtarıyla imza kampanyası başlat.",
          "Gönüllü ekiple sokak sanatçılarına destek sağla."
        ],
        zor: [
          "İki rakip grubu bir araya getirip barış görüşmesi yap.",
          "Ulusal platformda toplumsal bir konuda konuş.",
          "Büyük iş anlaşmazlığında arabulucu rol üstlen.",
          "Mahalle halkının taleplerini dile getirip sonuç al.",
          "Üniversite protestosunu uzlaşma yoluyla sonlandır.",
          "Esnaf arasındaki fiyat anlaşmazlığını uzlaştır.",
          "Binlerce kişilik tartışmayı sakinleştir.",
          "Sivil toplum zirvesinde temsilci olarak konuş."
        ],
        ileri: [
          "Bölgesel toplum hareketine önderlik et.",
          "Ulusal konferansta çözüm önerileri sun.",
          "Yerel siyasetçiler ve STK’ler arasında diyaloğu güçlendir.",
          "Barış çalıştayında moderatörlük yap.",
          "Kurumsal şirkette üst düzey müzakerelerde bulun.",
          "Mahalle gerginliğini uzlaşı belgesiyle sonlandır.",
          "Şehrin önde gelenleriyle büyük kampanya düzenle.",
          "Üniversitede 'Barışçıl İletişim ve Diplomasi' dersi ver."
        ],
        son: [
          "Uluslararası konferansta ülkeni temsil et.",
          "Farklı ülkelerden liderleri bir araya getir.",
          "Barışçıl çözümlerle ödül al.",
          "Büyük kampanyayla yasa değişikliğini sağla.",
          "Diplomatik krizde aracı rol üstlen.",
          "‘Barış ve Uzlaşma Vakfı’ kurarak projeler yönet.",
          "Önemli çatışma bölgelerine arabulucu olarak davet al.",
          "Tebrikler, baron oldunuz! Ana menüye dönüyorsunuz."
        ]
      },
      baron: {
        basit: [
          "Ufak çapta uyuşturucu satmayı dene.",
          "Mahallede küçük 'koruma ücreti' topla.",
          "Kafe/mekândan ufak haraç iste.",
          "Sokak satıcıları arasında rekabeti lehine çevir.",
          "Sahte marka ürünlerin satış ağını oluştur.",
          "Şantaj veya tehditle rakibi sustur.",
          "Ufak çetenin desteğiyle 'güvenlik' sağlandığını iddia et.",
          "Kaçak içki satışı yapan ekibe arka çık."
        ],
        orta: [
          "Esnaftan düzenli 'koruma parası' toplamaya başla.",
          "Polis/memurlarla rüşvet bağlantısı kur.",
          "Yasadışı kumar organizasyonu başlat.",
          "Rakip çeteyle gerginliği lehine çöz.",
          "Silah veya uyuşturucu sevkiyatına lojistik destek ver.",
          "Yasa dışı bahis mekanlarıyla anlaş.",
          "Kara para aklama için küçük sermaye oluştur.",
          "Gece kulübünün 'gizli ortak' statüsünü al."
        ],
        zor: [
          "Orta ölçekli uyuşturucu ağında distribütörlüğü ele al.",
          "Rakip baronun iş anlaşmasına sızıp bilgileri çal.",
          "Polis ve siyasi bağlantıları güçlendir.",
          "Büyük kazanç sağlayacak silah sevkiyatı organize et.",
          "Gece kulüpleri ve barlarda yatırımın tekeli olsun.",
          "Rakip çetenin liderini korkutarak saflarına katıl.",
          "Beyaz yakalı iş çevresinde kara para aklamayı genişlet.",
          "Orta düzey siyasetçilere fon sağlayarak nüfuzunu arttır."
        ],
        ileri: [
          "Uluslararası uyuşturucu hattına doğrudan giriş yap.",
          "Üst düzey bürokratlarla gizli anlaşmalar yap, dokunulmazlık sağla.",
          "Rakip baronlarla barış konferansı düzenleyip ittifak kur.",
          "Yurt dışı kara para aklama ofisleri aç.",
          "Güvenlik birimlerinde kilit isimleri satın al.",
          "Şehrin en büyük limanlarında kontrol sağla.",
          "Gösterişli hayır işleriyle meşrulaş.",
          "Casino, otel, gece kulübü zinciri kurarak yasadışı gelirleri yasal işletmeye dönüştür."
        ],
        son: [
          "Büyük kumarhane zinciri ve malikâne sahibi ol.",
          "Uluslararası mafya ağının ülke temsilcisini üstlen.",
          "Siyasete dolaylı girip seçim kampanyalarını fonla.",
          "Yeraltı dünyasında 'Baronlar Konseyi' kur.",
          "Devletin kritik kurumlarına adam yerleştir.",
          "Lüks yaşam sürerken yurt dışı yatırımları yönet.",
          "Rakip baronlara karşı koordineli operasyon yap.",
          "Tebrikler, baron oldunuz! Ana menüye dönüyorsunuz."
        ]
      }
    };
      
    // Global değişkenler
    let currentRank = "Vakur";  // Başlangıçta sadece Vakur aktif
    let vakurTaskCount = 0, hatipTaskCount = 0, baronTaskCount = 0;
    let isHatipUnlocked = false, isBaronUnlocked = false;
    let blueBadgeCount = 0, orangeBadgeCount = 0, redBadgeCount = 0;
    let money = 500000;
    let onur = 0;
    
    // Stat hesapları
    function getVakurKoruma() {
      let koruma = Math.floor(vakurTaskCount / 22);
      return (koruma % 661 === 0 && koruma > 0) ? 660 : koruma % 661;
    }
    function getHatipNufus() {
      let nufus = Math.floor(hatipTaskCount / 40) * 5;
      return (nufus % 201 === 0 && nufus > 0) ? 200 : nufus % 201;
    }
    function getBaronEtki() {
      let etki = Math.floor(baronTaskCount * 2);
      return (etki % 501 === 0 && etki > 0) ? 500 : etki % 501;
    }
      
    // Köy seyahati
    const villages = ["Asman", "Mizrin", "Qeruk", "Shuman", "Alizera", "Bubuk"];
    let currentVillage = "Asman";
      
    function updateStatBars() {
      // Vakur Barı
      let vakurValue = getVakurKoruma();
      let vakurYuzde = (vakurValue / 660) * 100;
      document.getElementById('vakurText').innerText = "Koruma: " + vakurValue + " (" + Math.floor(vakurYuzde) + "%)";
      document.getElementById('vakurFill').style.width = vakurYuzde + "%";
      // Hatip Barı
      if (isHatipUnlocked) {
        document.getElementById('hatipStat').classList.remove("lockedStat");
        let hatipValue = getHatipNufus();
        let hatipYuzde = (hatipValue / 200) * 100;
        document.getElementById('hatipText').innerText = "Nüfus: " + hatipValue + " (" + Math.floor(hatipYuzde) + "%)";
        document.getElementById('hatipFill').style.width = hatipYuzde + "%";
      } else {
        document.getElementById('hatipStat').classList.add("lockedStat");
      }
      // Baron Barı
      if (isBaronUnlocked) {
        document.getElementById('baronStat').classList.remove("lockedStat");
        let baronValue = getBaronEtki();
        let baronYuzde = (baronValue / 500) * 100;
        document.getElementById('baronText').innerText = "Etki: " + baronValue + " (" + Math.floor(baronYuzde) + "%)";
        document.getElementById('baronFill').style.width = baronYuzde + "%";
      } else {
        document.getElementById('baronStat').classList.add("lockedStat");
      }
    }
      
    function updateProfileInfo() {
      document.getElementById('currentVillageDisplay').innerText = currentVillage;
    }
      
    function updateMoneyUI() {
      document.getElementById('money').innerText = money;
    }
      
    function updateBadgesUI() {
      document.getElementById('blueBadgeCount').innerText = blueBadgeCount;
      document.getElementById('orangeBadgeCount').innerText = orangeBadgeCount;
      document.getElementById('redBadgeCount').innerText = redBadgeCount;
    }
      
    function selectRank(rank) {
      if (rank === "Vakur") currentRank = "Vakur";
      else if (rank === "Hatip") { if (!isHatipUnlocked) return; currentRank = "Hatip"; }
      else if (rank === "Baron") { if (!isBaronUnlocked) return; currentRank = "Baron"; }
      showMafiaTask();
      document.getElementById('taskContainer').classList.add('active');
    }
      
    function closeTaskContainer() {
      document.getElementById('taskContainer').classList.remove('active');
    }
      
    function showMafiaTask() {
      const container = document.getElementById('taskOptions');
      container.innerHTML = "";
      let taskCount, tierIndex, activeIndex, currentTier, taskList;
      
      if (currentRank === "Vakur") {
        taskCount = vakurTaskCount;
        tierIndex = Math.floor(taskCount / 8);
        activeIndex = taskCount % 8;
        currentTier = mafiaTierOrder[tierIndex % mafiaTierOrder.length];
        taskList = mafiaTasks.vakur[currentTier];
        document.getElementById('rankTitle').innerText = "Vakur Görevleri (" + currentTier + ")";
      } else if (currentRank === "Hatip") {
        taskCount = hatipTaskCount;
        tierIndex = Math.floor(taskCount / 8);
        activeIndex = taskCount % 8;
        currentTier = mafiaTierOrder[tierIndex % mafiaTierOrder.length];
        taskList = mafiaTasks.hatip[currentTier];
        document.getElementById('rankTitle').innerText = "Hatip Görevleri (" + currentTier + ")";
      } else if (currentRank === "Baron") {
        taskCount = baronTaskCount;
        tierIndex = Math.floor(taskCount / 8);
        activeIndex = taskCount % 8;
        currentTier = mafiaTierOrder[tierIndex % mafiaTierOrder.length];
        taskList = mafiaTasks.baron[currentTier];
        document.getElementById('rankTitle').innerText = "Baron Görevleri (" + currentTier + ")";
      }
      
      if (activeIndex === 0 && taskCount > 0) {
        if (currentTier === "basit") {
          alert("Tebrikler, basit görevleri bitti. Orta görevlere geçtiniz.");
        } else if (currentTier === "orta") {
          alert("Tebrikler, orta görevleri bitti. Zor görevlere geçtiniz.");
        } else if (currentTier === "zor") {
          alert("Tebrikler, zor görevleri bitti. İleri görevlere geçtiniz.");
        } else if (currentTier === "ileri") {
          alert("Tebrikler, ileri görevleri bitti. Son görevlere geçtiniz.");
        } else if (currentTier === "son") {
          if (currentRank === "Vakur") {
            alert("Tebrikler, hatip oldunuz! Ana menüye dönüyorsunuz.");
            isHatipUnlocked = true;
            document.getElementById('cardHatip').classList.remove('locked');
          } else if (currentRank === "Hatip") {
            alert("Tebrikler, baron oldunuz! Ana menüye dönüyorsunuz.");
            isBaronUnlocked = true;
            document.getElementById('cardBaron').classList.remove('locked');
          }
          closeTaskContainer();
          return;
        }
      }
      
      taskList.forEach((task, index) => {
        const div = document.createElement('div');
        div.classList.add('task-option');
        div.innerText = task;
        if (index < activeIndex) div.classList.add('completed');
        else if (index === activeIndex) {
          div.classList.add('active');
          div.addEventListener('click', mafiaTaskComplete);
        } else div.classList.add('locked');
        container.appendChild(div);
      });
      
      const prog = (activeIndex / 8) * 100;
      document.getElementById('progressBar').style.width = prog + "%";
      document.getElementById('progressText').innerText = Math.floor(prog) + "%";
    }
      
    function mafiaTaskComplete() {
      if (currentRank === "Vakur") {
        vakurTaskCount++;
        let rozet = Math.floor(Math.random() * 3) + 1;
        blueBadgeCount += rozet;
      } else if (currentRank === "Hatip") {
        hatipTaskCount++;
        let rozet = Math.floor(Math.random() * 3) + 1;
        orangeBadgeCount += rozet;
        onur += rozet;
      } else if (currentRank === "Baron") {
        baronTaskCount++;
        let rozet = Math.floor(Math.random() * 3) + 1;
        redBadgeCount += rozet;
        let cashGain = Math.floor(Math.random() * (800 - 300 + 1)) + 300;
        money += cashGain;
        if (blueBadgeCount > 0) blueBadgeCount--;
      }
      
      // Rütbe terfisi: Vakur 40 görevde Hatip, Hatip 40 görevde Baron
      if (currentRank === "Vakur" && vakurTaskCount >= 40 && !isHatipUnlocked) {
        isHatipUnlocked = true;
        document.getElementById('cardHatip').classList.remove('locked');
      }
      if (currentRank === "Hatip" && hatipTaskCount >= 40 && !isBaronUnlocked) {
        isBaronUnlocked = true;
        document.getElementById('cardBaron').classList.remove('locked');
      }
      
      updateStatBars();
      updateBadgesUI();
      updateMoneyUI();
      showMafiaTask();
    }
      
    function travelTo(village) {
      if (currentVillage === village) return;
      if (money < 500) {
        alert("Seyahat için yeterli paranız yok!");
        return;
      }
      money -= 500;
      currentVillage = village;
      updateMoneyUI();
      updateProfileInfo();
      alert("Şimdi " + currentVillage + " köyündesin!");
    }
      
    function updateProfileInfo() {
      document.getElementById('currentVillageDisplay').innerText = currentVillage;
    }
      
    function updateMoneyUI() {
      document.getElementById('money').innerText = money;
    }
      
    function updateBadgesUI() {
      document.getElementById('blueBadgeCount').innerText = blueBadgeCount;
      document.getElementById('orangeBadgeCount').innerText = orangeBadgeCount;
      document.getElementById('redBadgeCount').innerText = redBadgeCount;
    }
      
    // Ana Menüye Dön butonu: Mafia oyunundan çıkıp ana menüye geri dön
    function showMainMenu() {
      document.getElementById('mafiaGameContainer').style.display = 'none';
      document.getElementById('mainMenu').style.display = 'flex';
    }
      
    function showGame(game) {
      // Sadece Mafia oyunu seçilirse, ana menüde tek seçenek gözükecek.
      document.getElementById('mainMenu').style.display = 'none';
      if (game === 'mafia') {
        document.getElementById('mafiaGameContainer').style.display = 'block';
      }
    }
      
    // Başlangıç güncellemeleri
    updateStatBars();
    updateProfileInfo();
    updateMoneyUI();
    updateBadgesUI();
  </script>
</body>
</html>
